
/* WebCL Validator JSON header
{
    "version" : "1.0",
    "kernels" :
        {
            "advect_forward_euler" :
                {
                    "delta_time" :
                        {
                            "index" : 0,
                            "type" : "float"
                        },
                    "dims" :
                        {
                            "index" : 1,
                            "type" : "int3"
                        },
                    "H" :
                        {
                            "index" : 2,
                            "type" : "float"
                        },
                    "q" :
                        {
                            "index" : 3,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_q_size"
                        },
                    "_wcl_q_size" :
                        {
                            "index" : 4,
                            "type" : "ulong"
                        },
                    "q_prev" :
                        {
                            "index" : 5,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_q_prev_size"
                        },
                    "_wcl_q_prev_size" :
                        {
                            "index" : 6,
                            "type" : "ulong"
                        },
                    "u_prev" :
                        {
                            "index" : 7,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_u_prev_size"
                        },
                    "_wcl_u_prev_size" :
                        {
                            "index" : 8,
                            "type" : "ulong"
                        },
                    "v_prev" :
                        {
                            "index" : 9,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_v_prev_size"
                        },
                    "_wcl_v_prev_size" :
                        {
                            "index" : 10,
                            "type" : "ulong"
                        },
                    "w_prev" :
                        {
                            "index" : 11,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_w_prev_size"
                        },
                    "_wcl_w_prev_size" :
                        {
                            "index" : 12,
                            "type" : "ulong"
                        }
                },
            "advectRK2" :
                {
                    "delta_time" :
                        {
                            "index" : 0,
                            "type" : "float"
                        },
                    "dims" :
                        {
                            "index" : 1,
                            "type" : "int3"
                        },
                    "H" :
                        {
                            "index" : 2,
                            "type" : "float"
                        },
                    "q" :
                        {
                            "index" : 3,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_q_size"
                        },
                    "_wcl_q_size" :
                        {
                            "index" : 4,
                            "type" : "ulong"
                        },
                    "q_prev" :
                        {
                            "index" : 5,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_q_prev_size"
                        },
                    "_wcl_q_prev_size" :
                        {
                            "index" : 6,
                            "type" : "ulong"
                        },
                    "u_prev" :
                        {
                            "index" : 7,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_u_prev_size"
                        },
                    "_wcl_u_prev_size" :
                        {
                            "index" : 8,
                            "type" : "ulong"
                        },
                    "v_prev" :
                        {
                            "index" : 9,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_v_prev_size"
                        },
                    "_wcl_v_prev_size" :
                        {
                            "index" : 10,
                            "type" : "ulong"
                        },
                    "w_prev" :
                        {
                            "index" : 11,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_w_prev_size"
                        },
                    "_wcl_w_prev_size" :
                        {
                            "index" : 12,
                            "type" : "ulong"
                        }
                },
            "advect_velocity_RK2" :
                {
                    "delta_time" :
                        {
                            "index" : 0,
                            "type" : "float"
                        },
                    "dims" :
                        {
                            "index" : 1,
                            "type" : "int3"
                        },
                    "H" :
                        {
                            "index" : 2,
                            "type" : "float"
                        },
                    "u" :
                        {
                            "index" : 3,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_u_size"
                        },
                    "_wcl_u_size" :
                        {
                            "index" : 4,
                            "type" : "ulong"
                        },
                    "v" :
                        {
                            "index" : 5,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_v_size"
                        },
                    "_wcl_v_size" :
                        {
                            "index" : 6,
                            "type" : "ulong"
                        },
                    "w" :
                        {
                            "index" : 7,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_w_size"
                        },
                    "_wcl_w_size" :
                        {
                            "index" : 8,
                            "type" : "ulong"
                        },
                    "u_prev" :
                        {
                            "index" : 9,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_u_prev_size"
                        },
                    "_wcl_u_prev_size" :
                        {
                            "index" : 10,
                            "type" : "ulong"
                        },
                    "v_prev" :
                        {
                            "index" : 11,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_v_prev_size"
                        },
                    "_wcl_v_prev_size" :
                        {
                            "index" : 12,
                            "type" : "ulong"
                        },
                    "w_prev" :
                        {
                            "index" : 13,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_w_prev_size"
                        },
                    "_wcl_w_prev_size" :
                        {
                            "index" : 14,
                            "type" : "ulong"
                        }
                },
            "advect_velocity_forward_euler" :
                {
                    "delta_time" :
                        {
                            "index" : 0,
                            "type" : "float"
                        },
                    "dims" :
                        {
                            "index" : 1,
                            "type" : "int3"
                        },
                    "H" :
                        {
                            "index" : 2,
                            "type" : "float"
                        },
                    "u" :
                        {
                            "index" : 3,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_u_size"
                        },
                    "_wcl_u_size" :
                        {
                            "index" : 4,
                            "type" : "ulong"
                        },
                    "v" :
                        {
                            "index" : 5,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_v_size"
                        },
                    "_wcl_v_size" :
                        {
                            "index" : 6,
                            "type" : "ulong"
                        },
                    "w" :
                        {
                            "index" : 7,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_w_size"
                        },
                    "_wcl_w_size" :
                        {
                            "index" : 8,
                            "type" : "ulong"
                        },
                    "u_prev" :
                        {
                            "index" : 9,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_u_prev_size"
                        },
                    "_wcl_u_prev_size" :
                        {
                            "index" : 10,
                            "type" : "ulong"
                        },
                    "v_prev" :
                        {
                            "index" : 11,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_v_prev_size"
                        },
                    "_wcl_v_prev_size" :
                        {
                            "index" : 12,
                            "type" : "ulong"
                        },
                    "w_prev" :
                        {
                            "index" : 13,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_w_prev_size"
                        },
                    "_wcl_w_prev_size" :
                        {
                            "index" : 14,
                            "type" : "ulong"
                        }
                },
            "vorticity_confinement" :
                {
                    "u" :
                        {
                            "index" : 0,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_u_size"
                        },
                    "_wcl_u_size" :
                        {
                            "index" : 1,
                            "type" : "ulong"
                        },
                    "v" :
                        {
                            "index" : 2,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_v_size"
                        },
                    "_wcl_v_size" :
                        {
                            "index" : 3,
                            "type" : "ulong"
                        },
                    "w" :
                        {
                            "index" : 4,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_w_size"
                        },
                    "_wcl_w_size" :
                        {
                            "index" : 5,
                            "type" : "ulong"
                        },
                    "u_prev" :
                        {
                            "index" : 6,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_u_prev_size"
                        },
                    "_wcl_u_prev_size" :
                        {
                            "index" : 7,
                            "type" : "ulong"
                        },
                    "v_prev" :
                        {
                            "index" : 8,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_v_prev_size"
                        },
                    "_wcl_v_prev_size" :
                        {
                            "index" : 9,
                            "type" : "ulong"
                        },
                    "w_prev" :
                        {
                            "index" : 10,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_w_prev_size"
                        },
                    "_wcl_w_prev_size" :
                        {
                            "index" : 11,
                            "type" : "ulong"
                        },
                    "n" :
                        {
                            "index" : 12,
                            "type" : "int3"
                        },
                    "e" :
                        {
                            "index" : 13,
                            "type" : "float"
                        },
                    "dt" :
                        {
                            "index" : 14,
                            "type" : "float"
                        }
                },
            "calculate_divergence" :
                {
                    "divergence" :
                        {
                            "index" : 0,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_divergence_size"
                        },
                    "_wcl_divergence_size" :
                        {
                            "index" : 1,
                            "type" : "ulong"
                        },
                    "u" :
                        {
                            "index" : 2,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_u_size"
                        },
                    "_wcl_u_size" :
                        {
                            "index" : 3,
                            "type" : "ulong"
                        },
                    "v" :
                        {
                            "index" : 4,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_v_size"
                        },
                    "_wcl_v_size" :
                        {
                            "index" : 5,
                            "type" : "ulong"
                        },
                    "w" :
                        {
                            "index" : 6,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_w_size"
                        },
                    "_wcl_w_size" :
                        {
                            "index" : 7,
                            "type" : "ulong"
                        },
                    "n" :
                        {
                            "index" : 8,
                            "type" : "int3"
                        },
                    "dt" :
                        {
                            "index" : 9,
                            "type" : "float"
                        }
                },
            "zero_pressure" :
                {
                    "pressure" :
                        {
                            "index" : 0,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_pressure_size"
                        },
                    "_wcl_pressure_size" :
                        {
                            "index" : 1,
                            "type" : "ulong"
                        }
                },
            "vector_dot_product" :
                {
                    "a" :
                        {
                            "index" : 0,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_a_size"
                        },
                    "_wcl_a_size" :
                        {
                            "index" : 1,
                            "type" : "ulong"
                        },
                    "b" :
                        {
                            "index" : 2,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_b_size"
                        },
                    "_wcl_b_size" :
                        {
                            "index" : 3,
                            "type" : "ulong"
                        },
                    "n" :
                        {
                            "index" : 4,
                            "type" : "int"
                        }
                },
            "laplacian_mtx_vec_mult" :
                {
                    "out" :
                        {
                            "index" : 0,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_out_size"
                        },
                    "_wcl_out_size" :
                        {
                            "index" : 1,
                            "type" : "ulong"
                        },
                    "x" :
                        {
                            "index" : 2,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_x_size"
                        },
                    "_wcl_x_size" :
                        {
                            "index" : 3,
                            "type" : "ulong"
                        },
                    "n" :
                        {
                            "index" : 4,
                            "type" : "int3"
                        }
                },
            "pressure_solve" :
                {
                    "pressure" :
                        {
                            "index" : 0,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_pressure_size"
                        },
                    "_wcl_pressure_size" :
                        {
                            "index" : 1,
                            "type" : "ulong"
                        },
                    "pressure_prev" :
                        {
                            "index" : 2,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_pressure_prev_size"
                        },
                    "_wcl_pressure_prev_size" :
                        {
                            "index" : 3,
                            "type" : "ulong"
                        },
                    "divergence" :
                        {
                            "index" : 4,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_divergence_size"
                        },
                    "_wcl_divergence_size" :
                        {
                            "index" : 5,
                            "type" : "ulong"
                        },
                    "n" :
                        {
                            "index" : 6,
                            "type" : "int3"
                        },
                    "dt" :
                        {
                            "index" : 7,
                            "type" : "float"
                        }
                },
            "pressure_apply" :
                {
                    "u" :
                        {
                            "index" : 0,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_u_size"
                        },
                    "_wcl_u_size" :
                        {
                            "index" : 1,
                            "type" : "ulong"
                        },
                    "v" :
                        {
                            "index" : 2,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_v_size"
                        },
                    "_wcl_v_size" :
                        {
                            "index" : 3,
                            "type" : "ulong"
                        },
                    "w" :
                        {
                            "index" : 4,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_w_size"
                        },
                    "_wcl_w_size" :
                        {
                            "index" : 5,
                            "type" : "ulong"
                        },
                    "pressure" :
                        {
                            "index" : 6,
                            "type" : "float *",
                            "address-space" : "global",
                            "size-parameter" : "_wcl_pressure_size"
                        },
                    "_wcl_pressure_size" :
                        {
                            "index" : 7,
                            "type" : "ulong"
                        },
                    "n" :
                        {
                            "index" : 8,
                            "type" : "int3"
                        },
                    "dt" :
                        {
                            "index" : 9,
                            "type" : "float"
                        }
                }
        }
}
*/

// WebCL Validator: validation stage.
#define _WCL_ADDRESS_SPACE_private_MIN (((8 + (CHAR_BIT - 1)) / CHAR_BIT))
#define _WCL_ADDRESS_SPACE_private_ALIGNMENT (8/CHAR_BIT)
#define _WCL_ADDRESS_SPACE_global_MIN (((32 + (CHAR_BIT - 1)) / CHAR_BIT))
#define _WCL_ADDRESS_SPACE_global_ALIGNMENT (32/CHAR_BIT)
#define _WCL_ADDRESS_SPACE_local_MIN (((32 + (CHAR_BIT - 1)) / CHAR_BIT))
#define _WCL_ADDRESS_SPACE_local_ALIGNMENT (32/CHAR_BIT)
#define _WCL_ADDRESS_SPACE_constant_MIN (((8 + (CHAR_BIT - 1)) / CHAR_BIT))
#define _WCL_ADDRESS_SPACE_constant_ALIGNMENT (8/CHAR_BIT)
typedef struct {
    float3 _wcl_halfway_vel;
    float3 _wcl_backtraced_position;
    float3 _wcl_traced_velocity;
    float3 _wcl_new_vel;
    float _wcl_traced_q;
    float _wcl_2_traced_q;
    float3 _wcl_2_halfway_vel;
    float3 _wcl_2_backtraced_position;
} __attribute__ ((aligned (_WCL_ADDRESS_SPACE_private_ALIGNMENT))) _WclPrivates;

typedef struct {
    __global float *advect_forward_euler__q_min;
    __global float *advect_forward_euler__q_max;
    __global float *advect_forward_euler__q_prev_min;
    __global float *advect_forward_euler__q_prev_max;
    __global float *advect_forward_euler__u_prev_min;
    __global float *advect_forward_euler__u_prev_max;
    __global float *advect_forward_euler__v_prev_min;
    __global float *advect_forward_euler__v_prev_max;
    __global float *advect_forward_euler__w_prev_min;
    __global float *advect_forward_euler__w_prev_max;
    __global float *advectRK2__q_min;
    __global float *advectRK2__q_max;
    __global float *advectRK2__q_prev_min;
    __global float *advectRK2__q_prev_max;
    __global float *advectRK2__u_prev_min;
    __global float *advectRK2__u_prev_max;
    __global float *advectRK2__v_prev_min;
    __global float *advectRK2__v_prev_max;
    __global float *advectRK2__w_prev_min;
    __global float *advectRK2__w_prev_max;
    __global float *advect_velocity_RK2__u_min;
    __global float *advect_velocity_RK2__u_max;
    __global float *advect_velocity_RK2__v_min;
    __global float *advect_velocity_RK2__v_max;
    __global float *advect_velocity_RK2__w_min;
    __global float *advect_velocity_RK2__w_max;
    __global float *advect_velocity_RK2__u_prev_min;
    __global float *advect_velocity_RK2__u_prev_max;
    __global float *advect_velocity_RK2__v_prev_min;
    __global float *advect_velocity_RK2__v_prev_max;
    __global float *advect_velocity_RK2__w_prev_min;
    __global float *advect_velocity_RK2__w_prev_max;
    __global float *advect_velocity_forward_euler__u_min;
    __global float *advect_velocity_forward_euler__u_max;
    __global float *advect_velocity_forward_euler__v_min;
    __global float *advect_velocity_forward_euler__v_max;
    __global float *advect_velocity_forward_euler__w_min;
    __global float *advect_velocity_forward_euler__w_max;
    __global float *advect_velocity_forward_euler__u_prev_min;
    __global float *advect_velocity_forward_euler__u_prev_max;
    __global float *advect_velocity_forward_euler__v_prev_min;
    __global float *advect_velocity_forward_euler__v_prev_max;
    __global float *advect_velocity_forward_euler__w_prev_min;
    __global float *advect_velocity_forward_euler__w_prev_max;
    __global float *vorticity_confinement__u_min;
    __global float *vorticity_confinement__u_max;
    __global float *vorticity_confinement__v_min;
    __global float *vorticity_confinement__v_max;
    __global float *vorticity_confinement__w_min;
    __global float *vorticity_confinement__w_max;
    __global float *vorticity_confinement__u_prev_min;
    __global float *vorticity_confinement__u_prev_max;
    __global float *vorticity_confinement__v_prev_min;
    __global float *vorticity_confinement__v_prev_max;
    __global float *vorticity_confinement__w_prev_min;
    __global float *vorticity_confinement__w_prev_max;
    __global float *calculate_divergence__divergence_min;
    __global float *calculate_divergence__divergence_max;
    __global float *calculate_divergence__u_min;
    __global float *calculate_divergence__u_max;
    __global float *calculate_divergence__v_min;
    __global float *calculate_divergence__v_max;
    __global float *calculate_divergence__w_min;
    __global float *calculate_divergence__w_max;
    __global float *zero_pressure__pressure_min;
    __global float *zero_pressure__pressure_max;
    __global float *vector_dot_product__a_min;
    __global float *vector_dot_product__a_max;
    __global float *vector_dot_product__b_min;
    __global float *vector_dot_product__b_max;
    __global float *laplacian_mtx_vec_mult__out_min;
    __global float *laplacian_mtx_vec_mult__out_max;
    __global float *laplacian_mtx_vec_mult__x_min;
    __global float *laplacian_mtx_vec_mult__x_max;
    __global float *pressure_solve__pressure_min;
    __global float *pressure_solve__pressure_max;
    __global float *pressure_solve__pressure_prev_min;
    __global float *pressure_solve__pressure_prev_max;
    __global float *pressure_solve__divergence_min;
    __global float *pressure_solve__divergence_max;
    __global float *pressure_apply__u_min;
    __global float *pressure_apply__u_max;
    __global float *pressure_apply__v_min;
    __global float *pressure_apply__v_max;
    __global float *pressure_apply__w_min;
    __global float *pressure_apply__w_max;
    __global float *pressure_apply__pressure_min;
    __global float *pressure_apply__pressure_max;
} _WclGlobalLimits;

typedef struct {
    _WclGlobalLimits gl;
    __global uint *gn;
    _WclPrivates pa;
    __private uint *pn;
} _WclProgramAllocations;

__constant uint _wcl_constant_null[_WCL_ADDRESS_SPACE_constant_MIN] = { 0 };

// => General code that doesn't depend on input.

#define _WCL_MEMCPY(dst, src) for(ulong i = 0; i < sizeof((src))/sizeof((src)[0]); i++) { (dst)[i] = (src)[i]; }

#define _WCL_LAST(type, ptr) (((type)(ptr)) - 1)
#define _WCL_FILLCHAR ((uchar)0xCC)

// POCL crashes at run time if the parameters are local character
// pointers.
typedef uint _WclInitType;

// NOTE: this expects that null pointer is type of uint*
#define _WCL_SET_NULL(type, req_bytes, min, max, null) ( ((((type)max)-((type)min))*sizeof(uint) >= req_bytes) ? ((type)min) : (null) )

#ifdef cl_khr_initialize_memory
#pragma OPENCL EXTENSION cl_khr_initialize_memory : enable
#define _WCL_LOCAL_RANGE_INIT(begin, end)
#else

// be careful to edit this, this has been carefully tuned to work on every OpenCL driver
// e.g. % item_count was added to start[(items_offset+i)] = _WCL_FILLCHAR;
// to prevent compiler crash on Apple GeForce 640M
#define _WCL_LOCAL_RANGE_INIT(begin, end) do {               \
    __local uchar *start = (__local uchar *)begin;           \
    __local uchar *stop = (__local uchar *)end;              \
    const size_t z_items = get_local_size(2);                \
    const size_t yz_items = get_local_size(1) * z_items;     \
    const size_t xyz_items = get_local_size(0) * yz_items;   \
    const size_t item_index =                                \
        (get_local_id(0) * yz_items) +                       \
        (get_local_id(1) * z_items) +                        \
        get_local_id(2);                                     \
    size_t item_count = stop - start;                        \
    size_t items_per_kernel = item_count / xyz_items;        \
    size_t items_offset = items_per_kernel * item_index;     \
    size_t reminders = item_count % xyz_items;               \
    if (item_index < reminders) {                            \
        start[xyz_items*items_per_kernel + item_index] = _WCL_FILLCHAR; \
    }                                                                   \
    for (size_t i = 0; i < items_per_kernel; i++) {                     \
        start[(items_offset+i) % item_count] = _WCL_FILLCHAR;           \
    }                                                                   \
} while (0)                                                             \

#endif // cl_khr_initialize_memory

constant int hd4k_workaround_constant = 0;

// <= General code that doesn't depend on input.

bool _wcl_addr_check_global_44__u_uglobal__float__Ptr(__global float *addr, unsigned size, __global float * min0, __global float * max0, __global float * min1, __global float * max1, __global float * min2, __global float * max2, __global float * min3, __global float * max3, __global float * min4, __global float * max4, __global float * min5, __global float * max5, __global float * min6, __global float * max6, __global float * min7, __global float * max7, __global float * min8, __global float * max8, __global float * min9, __global float * max9, __global float * min10, __global float * max10, __global float * min11, __global float * max11, __global float * min12, __global float * max12, __global float * min13, __global float * max13, __global float * min14, __global float * max14, __global float * min15, __global float * max15, __global float * min16, __global float * max16, __global float * min17, __global float * max17, __global float * min18, __global float * max18, __global float * min19, __global float * max19, __global float * min20, __global float * max20, __global float * min21, __global float * max21, __global float * min22, __global float * max22, __global float * min23, __global float * max23, __global float * min24, __global float * max24, __global float * min25, __global float * max25, __global float * min26, __global float * max26, __global float * min27, __global float * max27, __global float * min28, __global float * max28, __global float * min29, __global float * max29, __global float * min30, __global float * max30, __global float * min31, __global float * max31, __global float * min32, __global float * max32, __global float * min33, __global float * max33, __global float * min34, __global float * max34, __global float * min35, __global float * max35, __global float * min36, __global float * max36, __global float * min37, __global float * max37, __global float * min38, __global float * max38, __global float * min39, __global float * max39, __global float * min40, __global float * max40, __global float * min41, __global float * max41, __global float * min42, __global float * max42, __global float * min43, __global float * max43)
{
      return 0
        || ( ((addr) >= (min0)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max0)) )
        || ( ((addr) >= (min1)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max1)) )
        || ( ((addr) >= (min2)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max2)) )
        || ( ((addr) >= (min3)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max3)) )
        || ( ((addr) >= (min4)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max4)) )
        || ( ((addr) >= (min5)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max5)) )
        || ( ((addr) >= (min6)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max6)) )
        || ( ((addr) >= (min7)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max7)) )
        || ( ((addr) >= (min8)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max8)) )
        || ( ((addr) >= (min9)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max9)) )
        || ( ((addr) >= (min10)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max10)) )
        || ( ((addr) >= (min11)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max11)) )
        || ( ((addr) >= (min12)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max12)) )
        || ( ((addr) >= (min13)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max13)) )
        || ( ((addr) >= (min14)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max14)) )
        || ( ((addr) >= (min15)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max15)) )
        || ( ((addr) >= (min16)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max16)) )
        || ( ((addr) >= (min17)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max17)) )
        || ( ((addr) >= (min18)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max18)) )
        || ( ((addr) >= (min19)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max19)) )
        || ( ((addr) >= (min20)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max20)) )
        || ( ((addr) >= (min21)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max21)) )
        || ( ((addr) >= (min22)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max22)) )
        || ( ((addr) >= (min23)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max23)) )
        || ( ((addr) >= (min24)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max24)) )
        || ( ((addr) >= (min25)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max25)) )
        || ( ((addr) >= (min26)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max26)) )
        || ( ((addr) >= (min27)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max27)) )
        || ( ((addr) >= (min28)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max28)) )
        || ( ((addr) >= (min29)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max29)) )
        || ( ((addr) >= (min30)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max30)) )
        || ( ((addr) >= (min31)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max31)) )
        || ( ((addr) >= (min32)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max32)) )
        || ( ((addr) >= (min33)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max33)) )
        || ( ((addr) >= (min34)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max34)) )
        || ( ((addr) >= (min35)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max35)) )
        || ( ((addr) >= (min36)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max36)) )
        || ( ((addr) >= (min37)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max37)) )
        || ( ((addr) >= (min38)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max38)) )
        || ( ((addr) >= (min39)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max39)) )
        || ( ((addr) >= (min40)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max40)) )
        || ( ((addr) >= (min41)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max41)) )
        || ( ((addr) >= (min42)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max42)) )
        || ( ((addr) >= (min43)) && ((addr + size - 1) <= _WCL_LAST(__global float *, max43)) );
}
__global float *_wcl_addr_clamp_global_44__u_uglobal__float__Ptr(__global float *addr, unsigned size, __global float * min0, __global float * max0, __global float * min1, __global float * max1, __global float * min2, __global float * max2, __global float * min3, __global float * max3, __global float * min4, __global float * max4, __global float * min5, __global float * max5, __global float * min6, __global float * max6, __global float * min7, __global float * max7, __global float * min8, __global float * max8, __global float * min9, __global float * max9, __global float * min10, __global float * max10, __global float * min11, __global float * max11, __global float * min12, __global float * max12, __global float * min13, __global float * max13, __global float * min14, __global float * max14, __global float * min15, __global float * max15, __global float * min16, __global float * max16, __global float * min17, __global float * max17, __global float * min18, __global float * max18, __global float * min19, __global float * max19, __global float * min20, __global float * max20, __global float * min21, __global float * max21, __global float * min22, __global float * max22, __global float * min23, __global float * max23, __global float * min24, __global float * max24, __global float * min25, __global float * max25, __global float * min26, __global float * max26, __global float * min27, __global float * max27, __global float * min28, __global float * max28, __global float * min29, __global float * max29, __global float * min30, __global float * max30, __global float * min31, __global float * max31, __global float * min32, __global float * max32, __global float * min33, __global float * max33, __global float * min34, __global float * max34, __global float * min35, __global float * max35, __global float * min36, __global float * max36, __global float * min37, __global float * max37, __global float * min38, __global float * max38, __global float * min39, __global float * max39, __global float * min40, __global float * max40, __global float * min41, __global float * max41, __global float * min42, __global float * max42, __global float * min43, __global float * max43, __global float * asnull)
{
     return _wcl_addr_check_global_44__u_uglobal__float__Ptr(addr, size, min0, max0, min1, max1, min2, max2, min3, max3, min4, max4, min5, max5, min6, max6, min7, max7, min8, max8, min9, max9, min10, max10, min11, max11, min12, max12, min13, max13, min14, max14, min15, max15, min16, max16, min17, max17, min18, max18, min19, max19, min20, max20, min21, max21, min22, max22, min23, max23, min24, max24, min25, max25, min26, max26, min27, max27, min28, max28, min29, max29, min30, max30, min31, max31, min32, max32, min33, max33, min34, max34, min35, max35, min36, max36, min37, max37, min38, max38, min39, max39, min40, max40, min41, max41, min42, max42, min43, max43) ? addr : asnull;
}

bool _wcl_addr_check_local_0__u_ulocal__float__Ptr(__local float *addr, unsigned size)
{
      return 0;
}
__local float *_wcl_addr_clamp_local_0__u_ulocal__float__Ptr(__local float *addr, unsigned size, __local float * asnull)
{
     return _wcl_addr_check_local_0__u_ulocal__float__Ptr(addr, size) ? addr : asnull;
}


// WebCL Validator: matching stage 2.
// WebCL Validator: matching stage 1.





int mod_int (_WclProgramAllocations *_wcl_allocs, int a, int b)
{
  if(b < 0) //you can check for b == 0 separately and do what you want
    return mod_int(_wcl_allocs, -a, -b);
  int ret = a % b;
  if(ret < 0)
    ret+=b;
  return ret;
}

float get_data(_WclProgramAllocations *_wcl_allocs, __global float * x, int i, int j, int k)
{
  //If I basically have a 2D grid then the 3 way check gives bad results
  //if(i < 0 || i >= NX || j < 0 || j >= NY || k < 0 || k >= NZ)
  //if(i < 0 || i >= NX || j < 0 || j >= NY)
  //{
  //  return 0.0f;
  //}


  i = clamp(i,0,96 -1);
  j = clamp(j,0,96 -1);
  k = clamp(k,0,1 -1);

  return (*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((x)+(((i) + ((j)*(96)) + ((k)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn)));
}

float get_data_local(_WclProgramAllocations *_wcl_allocs, __local float * x, int i, int j, int k)
{
  i = clamp(i,0,1 -1);
  j = clamp(j,0,1 -1);
  k = clamp(k,0,1 -1);

  return (*(_wcl_addr_clamp_local_0__u_ulocal__float__Ptr((x)+(((i) + ((j)*(1)) + ((k)*(1)*(1)))), 1, (__local float *)_wcl_allocs->ln)));
}

float get_interpolated_value(_WclProgramAllocations *_wcl_allocs, 
      __global float * x,
      float3 pos,
      float h)
{
   float3 ph = pos/h;
  //The grid world pos is 0-1.
   int3 idx0 = {convert_int(ph.x), convert_int(ph.y), convert_int(ph.z)};
   int3 idx1 = {
            convert_int(clamp(idx0.x + 1, 0,96 -1)),
            convert_int(clamp(idx0.y + 1, 0,96 -1)),
            convert_int(clamp(idx0.z + 1, 0,1 -1))
            };


  //Calculate t per component
   //float it,jt,kt;
   float3 t = {
            pos.x - idx0.x*h,
            pos.y - idx0.y*h,
            pos.z - idx0.z*h
            };


  //assert (t.x < 1.0 && t.x >= 0);
  //assert (t.y < 1.0 && t.y >= 0);
  //assert (t.z < 1.0 && t.z >= 0);

  // Assume a cube wt.xh 8 points
  //Front face
  //Top Front Lerp
  float xFrontLeftTop = (*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((x)+(((idx0.x) + ((idx1.y)*(96)) + ((idx0.z)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn)));
  float xFrontRightTop = (*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((x)+(((idx1.x) + ((idx1.y)*(96)) + ((idx0.z)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn)));
  float xFrontTopInterp = mix(xFrontLeftTop, xFrontRightTop, t.x);
  //Bottom Front Lerp
  float xFrontLeftBottom = (*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((x)+(((idx0.x) + ((idx0.y)*(96)) + ((idx0.z)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn)));
  float xFrontRightBottom = (*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((x)+(((idx1.x) + ((idx0.y)*(96)) + ((idx0.z)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn)));
  float xFrontBottomInterp = mix(xFrontLeftBottom, xFrontRightBottom, t.x);

  //Back face
  //Top Back Lerp
  float xBackLeftTop = (*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((x)+(((idx0.x) + ((idx1.y)*(96)) + ((idx1.z)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn)));
  float xBackRightTop = (*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((x)+(((idx1.x) + ((idx1.y)*(96)) + ((idx1.z)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn)));
  float xBackTopInterp = mix(xBackLeftTop, xBackRightTop, t.x);
  //Bottom Back Lerp
  float xBackLeftBottom = (*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((x)+(((idx0.x) + ((idx0.y)*(96)) + ((idx1.z)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn)));
  float xBackRightBottom = (*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((x)+(((idx1.x) + ((idx0.y)*(96)) + ((idx1.z)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn)));
  float xBackBottomInterp = mix(xBackLeftBottom, xBackRightBottom, t.x);


  //Now get middle of front -The bilinear interp of the front face
  float xBiLerpFront = mix(xFrontBottomInterp, xFrontTopInterp,t.y);

  //Now get middle of back -The bilinear interp of the back face
  float xBiLerpBack = mix(xBackBottomInterp, xBackTopInterp, t.y);

  //Now get the interpolated point between the points calculated in 
   //the front and back faces - The trilinear interp part
  float xTriLerp = mix(xBiLerpFront, xBiLerpBack, t.z);

  return xTriLerp;
}

__kernel void advect_forward_euler(
      const float delta_time,
      int3 dims,
      const float H,
      __global float *q, ulong _wcl_q_size,
      __global float * q_prev, ulong _wcl_q_prev_size,
      __global float * u_prev, ulong _wcl_u_prev_size,
      __global float * v_prev, ulong _wcl_v_prev_size,
      __global float * w_prev, ulong _wcl_w_prev_size
//      __global float4 * debugData1,
//      __global float4 * debugData2,
//      __global float4 * debugData3
                                   )
{
local int hd4k_workaround_local;
hd4k_workaround_local = hd4k_workaround_constant;
    __local uint _wcl_local_null[_WCL_ADDRESS_SPACE_local_MIN];

    _WclProgramAllocations _wcl_allocations_allocation = {
        { &q[0], &q[_wcl_q_size],&q_prev[0], &q_prev[_wcl_q_prev_size],&u_prev[0], &u_prev[_wcl_u_prev_size],&v_prev[0], &v_prev[_wcl_v_prev_size],&w_prev[0], &w_prev[_wcl_w_prev_size],0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0 },
        0,
        { },
        0

    };
    _WclProgramAllocations *_wcl_allocs = &_wcl_allocations_allocation;
    _wcl_allocs->gn = _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__q_min, _wcl_allocs->gl.advect_forward_euler__q_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__q_prev_min, _wcl_allocs->gl.advect_forward_euler__q_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__u_prev_min, _wcl_allocs->gl.advect_forward_euler__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__v_prev_min, _wcl_allocs->gl.advect_forward_euler__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__w_prev_min, _wcl_allocs->gl.advect_forward_euler__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__q_min, _wcl_allocs->gl.advectRK2__q_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__q_prev_min, _wcl_allocs->gl.advectRK2__q_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__u_prev_min, _wcl_allocs->gl.advectRK2__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__v_prev_min, _wcl_allocs->gl.advectRK2__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__w_prev_min, _wcl_allocs->gl.advectRK2__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__u_min, _wcl_allocs->gl.advect_velocity_RK2__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__v_min, _wcl_allocs->gl.advect_velocity_RK2__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__w_min, _wcl_allocs->gl.advect_velocity_RK2__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, _wcl_allocs->gl.advect_velocity_RK2__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, _wcl_allocs->gl.advect_velocity_RK2__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, _wcl_allocs->gl.advect_velocity_RK2__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__u_min, _wcl_allocs->gl.advect_velocity_forward_euler__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__v_min, _wcl_allocs->gl.advect_velocity_forward_euler__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__w_min, _wcl_allocs->gl.advect_velocity_forward_euler__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, _wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, _wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, _wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__u_min, _wcl_allocs->gl.vorticity_confinement__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__v_min, _wcl_allocs->gl.vorticity_confinement__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__w_min, _wcl_allocs->gl.vorticity_confinement__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__u_prev_min, _wcl_allocs->gl.vorticity_confinement__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__v_prev_min, _wcl_allocs->gl.vorticity_confinement__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__w_prev_min, _wcl_allocs->gl.vorticity_confinement__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__divergence_min, _wcl_allocs->gl.calculate_divergence__divergence_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__u_min, _wcl_allocs->gl.calculate_divergence__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__v_min, _wcl_allocs->gl.calculate_divergence__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__w_min, _wcl_allocs->gl.calculate_divergence__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.zero_pressure__pressure_min, _wcl_allocs->gl.zero_pressure__pressure_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vector_dot_product__a_min, _wcl_allocs->gl.vector_dot_product__a_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vector_dot_product__b_min, _wcl_allocs->gl.vector_dot_product__b_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, _wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, _wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_solve__pressure_min, _wcl_allocs->gl.pressure_solve__pressure_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_solve__pressure_prev_min, _wcl_allocs->gl.pressure_solve__pressure_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_solve__divergence_min, _wcl_allocs->gl.pressure_solve__divergence_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__u_min, _wcl_allocs->gl.pressure_apply__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__v_min, _wcl_allocs->gl.pressure_apply__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__w_min, _wcl_allocs->gl.pressure_apply__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__pressure_min, _wcl_allocs->gl.pressure_apply__pressure_max, (__global uint*)0))))))))))))))))))))))))))))))))))))))))))));
    if (_wcl_allocs->gn == (__global uint*)0) return; // not enough space to meet the minimum access. Would be great if we could give info about the problem for the user. 
    _wcl_allocs->pn = _WCL_SET_NULL(__private uint*, _WCL_ADDRESS_SPACE_private_MIN, &_wcl_allocs->pa, (&_wcl_allocs->pa + 1), (__private uint*)0);
    if (_wcl_allocs->pn == (__private uint*)0) return; // not enough space to meet the minimum access. Would be great if we could give info about the problem for the user. 

  int id = get_global_id(0);


  float dt = -delta_time*96;

  int slice_size = 96*96;
  int row_size = 96;
  int k = id / slice_size;
  int j = (id - k*slice_size) / row_size;
  int i = id - j*row_size - k*slice_size;

  float3 pos = {i*H, j*H, k*H};

  //debugData1[id] = pos.xyzx;

  float3 orig_vel = {
           (*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((u_prev)+(((i) + ((j)*(96)) + ((k)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn))),
           (*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((v_prev)+(((i) + ((j)*(96)) + ((k)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn))),
           (*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((w_prev)+(((i) + ((j)*(96)) + ((k)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn)))
  };

  //debugData1[id] = orig_vel.xyzx;

  float3 new_pos = {
           pos.x+(dt*orig_vel.x),
           pos.y+(dt*orig_vel.y),
           pos.z+(dt*orig_vel.z)
  };

  //debugData1[id] = new_pos.xyzx;


  new_pos.x = clamp(new_pos.x,0.0f,96 -1.0f);
  new_pos.y = clamp(new_pos.y,0.0f,96 -1.0f);
  new_pos.z = clamp(new_pos.z,0.0f,1 -1.0f);



  //Have to interpolate at new point
  float traced_q;
  _wcl_allocs->pa._wcl_traced_q = get_interpolated_value(_wcl_allocs,  q_prev, new_pos, H);


  (*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((q)+(id), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn))) = _wcl_allocs->pa._wcl_traced_q;

}



__kernel void advectRK2(
            const float delta_time,
            int3 dims,
            const float H,
            __global float * q, ulong _wcl_q_size,
            __global float * q_prev, ulong _wcl_q_prev_size,
            __global float * u_prev, ulong _wcl_u_prev_size,
            __global float * v_prev, ulong _wcl_v_prev_size,
            __global float * w_prev, ulong _wcl_w_prev_size
//            __global float4 * debugData1,
//            __global float4 * debugData2,
//            __global float4 * debugData3
                        )
{
local int hd4k_workaround_local;
hd4k_workaround_local = hd4k_workaround_constant;
    __local uint _wcl_local_null[_WCL_ADDRESS_SPACE_local_MIN];

    _WclProgramAllocations _wcl_allocations_allocation = {
        { 0, 0,0, 0,0, 0,0, 0,0, 0,&q[0], &q[_wcl_q_size],&q_prev[0], &q_prev[_wcl_q_prev_size],&u_prev[0], &u_prev[_wcl_u_prev_size],&v_prev[0], &v_prev[_wcl_v_prev_size],&w_prev[0], &w_prev[_wcl_w_prev_size],0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0 },
        0,
        { },
        0

    };
    _WclProgramAllocations *_wcl_allocs = &_wcl_allocations_allocation;
    _wcl_allocs->gn = _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__q_min, _wcl_allocs->gl.advect_forward_euler__q_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__q_prev_min, _wcl_allocs->gl.advect_forward_euler__q_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__u_prev_min, _wcl_allocs->gl.advect_forward_euler__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__v_prev_min, _wcl_allocs->gl.advect_forward_euler__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__w_prev_min, _wcl_allocs->gl.advect_forward_euler__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__q_min, _wcl_allocs->gl.advectRK2__q_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__q_prev_min, _wcl_allocs->gl.advectRK2__q_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__u_prev_min, _wcl_allocs->gl.advectRK2__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__v_prev_min, _wcl_allocs->gl.advectRK2__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__w_prev_min, _wcl_allocs->gl.advectRK2__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__u_min, _wcl_allocs->gl.advect_velocity_RK2__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__v_min, _wcl_allocs->gl.advect_velocity_RK2__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__w_min, _wcl_allocs->gl.advect_velocity_RK2__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, _wcl_allocs->gl.advect_velocity_RK2__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, _wcl_allocs->gl.advect_velocity_RK2__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, _wcl_allocs->gl.advect_velocity_RK2__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__u_min, _wcl_allocs->gl.advect_velocity_forward_euler__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__v_min, _wcl_allocs->gl.advect_velocity_forward_euler__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__w_min, _wcl_allocs->gl.advect_velocity_forward_euler__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, _wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, _wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, _wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__u_min, _wcl_allocs->gl.vorticity_confinement__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__v_min, _wcl_allocs->gl.vorticity_confinement__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__w_min, _wcl_allocs->gl.vorticity_confinement__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__u_prev_min, _wcl_allocs->gl.vorticity_confinement__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__v_prev_min, _wcl_allocs->gl.vorticity_confinement__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__w_prev_min, _wcl_allocs->gl.vorticity_confinement__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__divergence_min, _wcl_allocs->gl.calculate_divergence__divergence_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__u_min, _wcl_allocs->gl.calculate_divergence__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__v_min, _wcl_allocs->gl.calculate_divergence__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__w_min, _wcl_allocs->gl.calculate_divergence__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.zero_pressure__pressure_min, _wcl_allocs->gl.zero_pressure__pressure_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vector_dot_product__a_min, _wcl_allocs->gl.vector_dot_product__a_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vector_dot_product__b_min, _wcl_allocs->gl.vector_dot_product__b_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, _wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, _wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_solve__pressure_min, _wcl_allocs->gl.pressure_solve__pressure_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_solve__pressure_prev_min, _wcl_allocs->gl.pressure_solve__pressure_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_solve__divergence_min, _wcl_allocs->gl.pressure_solve__divergence_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__u_min, _wcl_allocs->gl.pressure_apply__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__v_min, _wcl_allocs->gl.pressure_apply__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__w_min, _wcl_allocs->gl.pressure_apply__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__pressure_min, _wcl_allocs->gl.pressure_apply__pressure_max, (__global uint*)0))))))))))))))))))))))))))))))))))))))))))));
    if (_wcl_allocs->gn == (__global uint*)0) return; // not enough space to meet the minimum access. Would be great if we could give info about the problem for the user. 
    _wcl_allocs->pn = _WCL_SET_NULL(__private uint*, _WCL_ADDRESS_SPACE_private_MIN, &_wcl_allocs->pa, (&_wcl_allocs->pa + 1), (__private uint*)0);
    if (_wcl_allocs->pn == (__private uint*)0) return; // not enough space to meet the minimum access. Would be great if we could give info about the problem for the user. 

  int id = get_global_id(0);


  float dt = -delta_time*96;

  //FOR_EACH_FACE
  //{
  int slice_size = 96*96;
  int row_size = 96;
  int k = id / slice_size;
  int j = (id - k*slice_size) / row_size;
  int i = id - j*row_size - k*slice_size;

  float3 pos = {i*H, j*H, k*H};
  float3 orig_vel = {(*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((u_prev)+(((i) + ((j)*(96)) + ((k)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn))),(*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((v_prev)+(((i) + ((j)*(96)) + ((k)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn))),(*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((w_prev)+(((i) + ((j)*(96)) + ((k)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn)))};


  //RK2
  // What is u(x)?  value(such as velocity) at x i guess
  //y = x + dt*u(x + (dt/2)*u(x))

  //backtrace based upon current velocity at cell center.
  float halfDT = 0.5f*dt;
  float3 halfway_position = {
    pos.x+(halfDT*orig_vel.x),
    pos.y+(halfDT*orig_vel.y),
    pos.z+(halfDT*orig_vel.z)
  };


  halfway_position.x = clamp(halfway_position.x,0.0f,96 -1.0f);
  halfway_position.y = clamp(halfway_position.y,0.0f,96 -1.0f);
  halfway_position.z = clamp(halfway_position.z,0.0f,1 -1.0f);


  float3 halfway_vel;
  _wcl_allocs->pa._wcl_2_halfway_vel.x = get_interpolated_value(_wcl_allocs, u_prev, halfway_position,H);
  _wcl_allocs->pa._wcl_2_halfway_vel.y = get_interpolated_value(_wcl_allocs, v_prev, halfway_position,H);
  _wcl_allocs->pa._wcl_2_halfway_vel.z = get_interpolated_value(_wcl_allocs, w_prev, halfway_position,H);

  float3 backtraced_position;
  _wcl_allocs->pa._wcl_2_backtraced_position.x = pos.x + dt*_wcl_allocs->pa._wcl_2_halfway_vel.x;
  _wcl_allocs->pa._wcl_2_backtraced_position.y = pos.y + dt*_wcl_allocs->pa._wcl_2_halfway_vel.y;
  _wcl_allocs->pa._wcl_2_backtraced_position.z = pos.z + dt*_wcl_allocs->pa._wcl_2_halfway_vel.z;



  _wcl_allocs->pa._wcl_2_backtraced_position.x = clamp(_wcl_allocs->pa._wcl_2_backtraced_position.x,0.0f,96 -1.0f);
  _wcl_allocs->pa._wcl_2_backtraced_position.y = clamp(_wcl_allocs->pa._wcl_2_backtraced_position.y,0.0f,96 -1.0f);
  _wcl_allocs->pa._wcl_2_backtraced_position.z = clamp(_wcl_allocs->pa._wcl_2_backtraced_position.z,0.0f,1 -1.0f);



  //Have to interpolate at new point
  float traced_q;
  _wcl_allocs->pa._wcl_2_traced_q = get_interpolated_value(_wcl_allocs, q_prev, _wcl_allocs->pa._wcl_2_backtraced_position,H);

  //Has to be set on u
  (*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((q)+(((i) + ((j)*(96)) + ((k)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn))) = _wcl_allocs->pa._wcl_2_traced_q;

  //}
}


__kernel void advect_velocity_RK2(
                         const float delta_time,
                         int3 dims,
                         const float H,
                         __global float * u, ulong _wcl_u_size,
                         __global float * v, ulong _wcl_v_size,
                         __global float * w, ulong _wcl_w_size,
                         __global float * u_prev, ulong _wcl_u_prev_size,
                         __global float * v_prev, ulong _wcl_v_prev_size,
                         __global float * w_prev, ulong _wcl_w_prev_size
//                         __global float4 * debugData1,
//                         __global float4 * debugData2,
//                         __global float4 * debugData3
                                  )

{
local int hd4k_workaround_local;
hd4k_workaround_local = hd4k_workaround_constant;
    __local uint _wcl_local_null[_WCL_ADDRESS_SPACE_local_MIN];

    _WclProgramAllocations _wcl_allocations_allocation = {
        { 0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,&u[0], &u[_wcl_u_size],&v[0], &v[_wcl_v_size],&w[0], &w[_wcl_w_size],&u_prev[0], &u_prev[_wcl_u_prev_size],&v_prev[0], &v_prev[_wcl_v_prev_size],&w_prev[0], &w_prev[_wcl_w_prev_size],0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0 },
        0,
        { },
        0

    };
    _WclProgramAllocations *_wcl_allocs = &_wcl_allocations_allocation;
    _wcl_allocs->gn = _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__q_min, _wcl_allocs->gl.advect_forward_euler__q_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__q_prev_min, _wcl_allocs->gl.advect_forward_euler__q_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__u_prev_min, _wcl_allocs->gl.advect_forward_euler__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__v_prev_min, _wcl_allocs->gl.advect_forward_euler__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__w_prev_min, _wcl_allocs->gl.advect_forward_euler__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__q_min, _wcl_allocs->gl.advectRK2__q_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__q_prev_min, _wcl_allocs->gl.advectRK2__q_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__u_prev_min, _wcl_allocs->gl.advectRK2__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__v_prev_min, _wcl_allocs->gl.advectRK2__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__w_prev_min, _wcl_allocs->gl.advectRK2__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__u_min, _wcl_allocs->gl.advect_velocity_RK2__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__v_min, _wcl_allocs->gl.advect_velocity_RK2__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__w_min, _wcl_allocs->gl.advect_velocity_RK2__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, _wcl_allocs->gl.advect_velocity_RK2__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, _wcl_allocs->gl.advect_velocity_RK2__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, _wcl_allocs->gl.advect_velocity_RK2__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__u_min, _wcl_allocs->gl.advect_velocity_forward_euler__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__v_min, _wcl_allocs->gl.advect_velocity_forward_euler__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__w_min, _wcl_allocs->gl.advect_velocity_forward_euler__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, _wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, _wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, _wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__u_min, _wcl_allocs->gl.vorticity_confinement__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__v_min, _wcl_allocs->gl.vorticity_confinement__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__w_min, _wcl_allocs->gl.vorticity_confinement__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__u_prev_min, _wcl_allocs->gl.vorticity_confinement__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__v_prev_min, _wcl_allocs->gl.vorticity_confinement__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__w_prev_min, _wcl_allocs->gl.vorticity_confinement__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__divergence_min, _wcl_allocs->gl.calculate_divergence__divergence_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__u_min, _wcl_allocs->gl.calculate_divergence__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__v_min, _wcl_allocs->gl.calculate_divergence__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__w_min, _wcl_allocs->gl.calculate_divergence__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.zero_pressure__pressure_min, _wcl_allocs->gl.zero_pressure__pressure_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vector_dot_product__a_min, _wcl_allocs->gl.vector_dot_product__a_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vector_dot_product__b_min, _wcl_allocs->gl.vector_dot_product__b_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, _wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, _wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_solve__pressure_min, _wcl_allocs->gl.pressure_solve__pressure_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_solve__pressure_prev_min, _wcl_allocs->gl.pressure_solve__pressure_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_solve__divergence_min, _wcl_allocs->gl.pressure_solve__divergence_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__u_min, _wcl_allocs->gl.pressure_apply__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__v_min, _wcl_allocs->gl.pressure_apply__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__w_min, _wcl_allocs->gl.pressure_apply__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__pressure_min, _wcl_allocs->gl.pressure_apply__pressure_max, (__global uint*)0))))))))))))))))))))))))))))))))))))))))))));
    if (_wcl_allocs->gn == (__global uint*)0) return; // not enough space to meet the minimum access. Would be great if we could give info about the problem for the user. 
    _wcl_allocs->pn = _WCL_SET_NULL(__private uint*, _WCL_ADDRESS_SPACE_private_MIN, &_wcl_allocs->pa, (&_wcl_allocs->pa + 1), (__private uint*)0);
    if (_wcl_allocs->pn == (__private uint*)0) return; // not enough space to meet the minimum access. Would be great if we could give info about the problem for the user. 

  int id = get_global_id(0);

  float dt = -delta_time*96;

  int slice_size = 96*96;
  int row_size = 96;
  int k = id / slice_size;
  int j = (id - k*slice_size) / row_size;
  int i = id - j*row_size - k*slice_size;


  float3 pos = {i*H,j*H,k*H};
  float3 orig_vel = {(*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((u_prev)+(((i) + ((j)*(96)) + ((k)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn))),(*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((v_prev)+(((i) + ((j)*(96)) + ((k)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn))),(*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((w_prev)+(((i) + ((j)*(96)) + ((k)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn)))};

  //RK2
  // What is u(x)?  value(such as velocity) at x i guess
  //y = x + dt*u(x + (dt/2)*u(x))

  //backtrace based upon current velocity at cell center.
  float halfDT = 0.5f*dt;
  float3 halfway_position = {
    pos.x+(halfDT*orig_vel.x),
    pos.y+(halfDT*orig_vel.y),
    pos.z+(halfDT*orig_vel.z)
  };


  halfway_position.x = clamp(halfway_position.x,0.0f,96 -1.0f);
  halfway_position.y = clamp(halfway_position.y,0.0f,96 -1.0f);
  halfway_position.z = clamp(halfway_position.z,0.0f,1 -1.0f);


  float3 halfway_vel;
  _wcl_allocs->pa._wcl_halfway_vel.x = get_interpolated_value(_wcl_allocs, u_prev, halfway_position,H);
  _wcl_allocs->pa._wcl_halfway_vel.y = get_interpolated_value(_wcl_allocs, v_prev, halfway_position,H);
  _wcl_allocs->pa._wcl_halfway_vel.z = get_interpolated_value(_wcl_allocs, w_prev, halfway_position,H);

  float3 backtraced_position;
  _wcl_allocs->pa._wcl_backtraced_position.x = pos.x + dt*_wcl_allocs->pa._wcl_halfway_vel.x;
  _wcl_allocs->pa._wcl_backtraced_position.y = pos.y + dt*_wcl_allocs->pa._wcl_halfway_vel.y;
  _wcl_allocs->pa._wcl_backtraced_position.z = pos.z + dt*_wcl_allocs->pa._wcl_halfway_vel.z;



  _wcl_allocs->pa._wcl_backtraced_position.x = clamp(_wcl_allocs->pa._wcl_backtraced_position.x,0.0f,96 -1.0f);
  _wcl_allocs->pa._wcl_backtraced_position.y = clamp(_wcl_allocs->pa._wcl_backtraced_position.y,0.0f,96 -1.0f);
  _wcl_allocs->pa._wcl_backtraced_position.z = clamp(_wcl_allocs->pa._wcl_backtraced_position.z,0.0f,1 -1.0f);



  //Have to interpolate at new point
  float3 traced_velocity;
  _wcl_allocs->pa._wcl_traced_velocity.x = get_interpolated_value(_wcl_allocs, u_prev, _wcl_allocs->pa._wcl_backtraced_position,H);
  _wcl_allocs->pa._wcl_traced_velocity.y = get_interpolated_value(_wcl_allocs, v_prev, _wcl_allocs->pa._wcl_backtraced_position,H);
  _wcl_allocs->pa._wcl_traced_velocity.z = get_interpolated_value(_wcl_allocs, w_prev, _wcl_allocs->pa._wcl_backtraced_position,H);

  //Has to be set on u
  (*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((u)+(((i) + ((j)*(96)) + ((k)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn))) = _wcl_allocs->pa._wcl_traced_velocity.x;
  (*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((v)+(((i) + ((j)*(96)) + ((k)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn))) = _wcl_allocs->pa._wcl_traced_velocity.y;
  (*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((w)+(((i) + ((j)*(96)) + ((k)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn))) = _wcl_allocs->pa._wcl_traced_velocity.z;

}

__kernel void advect_velocity_forward_euler(
                                  const float delta_time,
                                  int3 dims,
                                  const float H,
                                  __global float * u, ulong _wcl_u_size,
                                  __global float * v, ulong _wcl_v_size,
                                  __global float * w, ulong _wcl_w_size,
                                  __global float * u_prev, ulong _wcl_u_prev_size,
                                  __global float * v_prev, ulong _wcl_v_prev_size,
                                  __global float * w_prev, ulong _wcl_w_prev_size
//                                  __global float4 * debugData1,
//                                  __global float4 * debugData2,
//                                  __global float4 * debugData3
                                            )

{
local int hd4k_workaround_local;
hd4k_workaround_local = hd4k_workaround_constant;
    __local uint _wcl_local_null[_WCL_ADDRESS_SPACE_local_MIN];

    _WclProgramAllocations _wcl_allocations_allocation = {
        { 0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,&u[0], &u[_wcl_u_size],&v[0], &v[_wcl_v_size],&w[0], &w[_wcl_w_size],&u_prev[0], &u_prev[_wcl_u_prev_size],&v_prev[0], &v_prev[_wcl_v_prev_size],&w_prev[0], &w_prev[_wcl_w_prev_size],0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0 },
        0,
        { },
        0

    };
    _WclProgramAllocations *_wcl_allocs = &_wcl_allocations_allocation;
    _wcl_allocs->gn = _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__q_min, _wcl_allocs->gl.advect_forward_euler__q_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__q_prev_min, _wcl_allocs->gl.advect_forward_euler__q_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__u_prev_min, _wcl_allocs->gl.advect_forward_euler__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__v_prev_min, _wcl_allocs->gl.advect_forward_euler__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__w_prev_min, _wcl_allocs->gl.advect_forward_euler__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__q_min, _wcl_allocs->gl.advectRK2__q_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__q_prev_min, _wcl_allocs->gl.advectRK2__q_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__u_prev_min, _wcl_allocs->gl.advectRK2__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__v_prev_min, _wcl_allocs->gl.advectRK2__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__w_prev_min, _wcl_allocs->gl.advectRK2__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__u_min, _wcl_allocs->gl.advect_velocity_RK2__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__v_min, _wcl_allocs->gl.advect_velocity_RK2__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__w_min, _wcl_allocs->gl.advect_velocity_RK2__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, _wcl_allocs->gl.advect_velocity_RK2__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, _wcl_allocs->gl.advect_velocity_RK2__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, _wcl_allocs->gl.advect_velocity_RK2__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__u_min, _wcl_allocs->gl.advect_velocity_forward_euler__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__v_min, _wcl_allocs->gl.advect_velocity_forward_euler__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__w_min, _wcl_allocs->gl.advect_velocity_forward_euler__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, _wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, _wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, _wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__u_min, _wcl_allocs->gl.vorticity_confinement__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__v_min, _wcl_allocs->gl.vorticity_confinement__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__w_min, _wcl_allocs->gl.vorticity_confinement__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__u_prev_min, _wcl_allocs->gl.vorticity_confinement__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__v_prev_min, _wcl_allocs->gl.vorticity_confinement__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__w_prev_min, _wcl_allocs->gl.vorticity_confinement__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__divergence_min, _wcl_allocs->gl.calculate_divergence__divergence_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__u_min, _wcl_allocs->gl.calculate_divergence__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__v_min, _wcl_allocs->gl.calculate_divergence__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__w_min, _wcl_allocs->gl.calculate_divergence__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.zero_pressure__pressure_min, _wcl_allocs->gl.zero_pressure__pressure_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vector_dot_product__a_min, _wcl_allocs->gl.vector_dot_product__a_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vector_dot_product__b_min, _wcl_allocs->gl.vector_dot_product__b_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, _wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, _wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_solve__pressure_min, _wcl_allocs->gl.pressure_solve__pressure_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_solve__pressure_prev_min, _wcl_allocs->gl.pressure_solve__pressure_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_solve__divergence_min, _wcl_allocs->gl.pressure_solve__divergence_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__u_min, _wcl_allocs->gl.pressure_apply__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__v_min, _wcl_allocs->gl.pressure_apply__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__w_min, _wcl_allocs->gl.pressure_apply__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__pressure_min, _wcl_allocs->gl.pressure_apply__pressure_max, (__global uint*)0))))))))))))))))))))))))))))))))))))))))))));
    if (_wcl_allocs->gn == (__global uint*)0) return; // not enough space to meet the minimum access. Would be great if we could give info about the problem for the user. 
    _wcl_allocs->pn = _WCL_SET_NULL(__private uint*, _WCL_ADDRESS_SPACE_private_MIN, &_wcl_allocs->pa, (&_wcl_allocs->pa + 1), (__private uint*)0);
    if (_wcl_allocs->pn == (__private uint*)0) return; // not enough space to meet the minimum access. Would be great if we could give info about the problem for the user. 

  int id = get_global_id(0);
  int slice_size = 96*96;
  int row_size = 96;
  int k = id / slice_size;
  int j = (id - k*slice_size) / row_size;
  int i = id - j*row_size - k*slice_size;

  float dt = -delta_time * 96;

  float3 pos = {i*H,j*H,k*H};
  float3 orig_vel = {(*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((u_prev)+(((i) + ((j)*(96)) + ((k)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn))),(*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((v_prev)+(((i) + ((j)*(96)) + ((k)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn))),(*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((w_prev)+(((i) + ((j)*(96)) + ((k)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn)))};

  float3 new_pos = {
    pos.x+(dt*orig_vel.x),
    pos.y+(dt*orig_vel.y),
    pos.z+(dt*orig_vel.z)
  };


  new_pos.x = clamp(new_pos.x,0.0f,96 -1.0f);
  new_pos.y = clamp(new_pos.y,0.0f,96 -1.0f);
  new_pos.z = clamp(new_pos.z,0.0f,1 -1.0f);


  float3 new_vel;
  _wcl_allocs->pa._wcl_new_vel.x = get_interpolated_value(_wcl_allocs, u_prev, new_pos,H);
  _wcl_allocs->pa._wcl_new_vel.y = get_interpolated_value(_wcl_allocs, v_prev, new_pos,H);
  _wcl_allocs->pa._wcl_new_vel.z = get_interpolated_value(_wcl_allocs, w_prev, new_pos,H);


  //Has to be set on u
  (*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((u)+(((i) + ((j)*(96)) + ((k)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn))) = _wcl_allocs->pa._wcl_new_vel.x;
  (*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((v)+(((i) + ((j)*(96)) + ((k)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn))) = _wcl_allocs->pa._wcl_new_vel.y;
  (*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((w)+(((i) + ((j)*(96)) + ((k)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn))) = _wcl_allocs->pa._wcl_new_vel.z;

//  if(id == 112)
//  {
//    printf("dt = %3.2f\n",dt);
//    printf("NX = %d\n",NX);
//    printf("pos = %3.2f,%3.2f,%3.2f\n",pos.x,pos.y,pos.z);
//    printf("new_pos = %3.2f,%3.2f,%3.2f\n",new_pos.x,new_pos.y,new_pos.z);
//    
//  }
//  
}

float4 safe_normalize(_WclProgramAllocations *_wcl_allocs, float4 p)
{
  float4 v = p;
  float l = length(v);
  if(l > 0.0f)
  {
    v = normalize(v);
  }
  else
  {
    v.xyzw = 0.0f;
  }
  return v;
}

float4 get_curl(_WclProgramAllocations *_wcl_allocs, 
                __global float * u,
                __global float * v,
                __global float * w,
                int i, int j, int k)
{
  float dwdj = 0.5f*(get_data(_wcl_allocs, w, i, j+1, k) - get_data(_wcl_allocs, w,i, j-1, k));
  float dwdi = 0.5f*(get_data(_wcl_allocs, w, i+1, j, k) - get_data(_wcl_allocs, w,i-1, j, k));

  float dudk = 0.5f*(get_data(_wcl_allocs, u, i, j, k+1)-get_data(_wcl_allocs, u, i, j, k-1));
  float dudj = 0.5f*(get_data(_wcl_allocs, u, i, j+1, k)-get_data(_wcl_allocs, u, i, j-1, k));

  float dvdk = 0.5f*(get_data(_wcl_allocs, v, i, j, k+1)-get_data(_wcl_allocs, v, i, j, k-1));
  float dvdi = 0.5f*(get_data(_wcl_allocs, v, i+1, j, k)-get_data(_wcl_allocs, v, i-1, j, k));

  float4 out = {dwdj-dvdk, dudk-dwdi, dvdi-dudj,0.0f};
  return out;
}
__kernel void vorticity_confinement(__global float *u, ulong _wcl_u_size,
                                    __global float *v, ulong _wcl_v_size,
                                    __global float* w, ulong _wcl_w_size,
                                    __global float * u_prev, ulong _wcl_u_prev_size,
                                    __global float * v_prev, ulong _wcl_v_prev_size,
                                    __global float * w_prev, ulong _wcl_w_prev_size,
                                    int3 n,
                                    float e,
                                    float dt)
{
local int hd4k_workaround_local;
hd4k_workaround_local = hd4k_workaround_constant;
    __local uint _wcl_local_null[_WCL_ADDRESS_SPACE_local_MIN];

    _WclProgramAllocations _wcl_allocations_allocation = {
        { 0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,&u[0], &u[_wcl_u_size],&v[0], &v[_wcl_v_size],&w[0], &w[_wcl_w_size],&u_prev[0], &u_prev[_wcl_u_prev_size],&v_prev[0], &v_prev[_wcl_v_prev_size],&w_prev[0], &w_prev[_wcl_w_prev_size],0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0 },
        0,
        { },
        0

    };
    _WclProgramAllocations *_wcl_allocs = &_wcl_allocations_allocation;
    _wcl_allocs->gn = _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__q_min, _wcl_allocs->gl.advect_forward_euler__q_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__q_prev_min, _wcl_allocs->gl.advect_forward_euler__q_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__u_prev_min, _wcl_allocs->gl.advect_forward_euler__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__v_prev_min, _wcl_allocs->gl.advect_forward_euler__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__w_prev_min, _wcl_allocs->gl.advect_forward_euler__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__q_min, _wcl_allocs->gl.advectRK2__q_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__q_prev_min, _wcl_allocs->gl.advectRK2__q_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__u_prev_min, _wcl_allocs->gl.advectRK2__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__v_prev_min, _wcl_allocs->gl.advectRK2__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__w_prev_min, _wcl_allocs->gl.advectRK2__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__u_min, _wcl_allocs->gl.advect_velocity_RK2__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__v_min, _wcl_allocs->gl.advect_velocity_RK2__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__w_min, _wcl_allocs->gl.advect_velocity_RK2__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, _wcl_allocs->gl.advect_velocity_RK2__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, _wcl_allocs->gl.advect_velocity_RK2__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, _wcl_allocs->gl.advect_velocity_RK2__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__u_min, _wcl_allocs->gl.advect_velocity_forward_euler__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__v_min, _wcl_allocs->gl.advect_velocity_forward_euler__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__w_min, _wcl_allocs->gl.advect_velocity_forward_euler__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, _wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, _wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, _wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__u_min, _wcl_allocs->gl.vorticity_confinement__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__v_min, _wcl_allocs->gl.vorticity_confinement__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__w_min, _wcl_allocs->gl.vorticity_confinement__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__u_prev_min, _wcl_allocs->gl.vorticity_confinement__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__v_prev_min, _wcl_allocs->gl.vorticity_confinement__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__w_prev_min, _wcl_allocs->gl.vorticity_confinement__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__divergence_min, _wcl_allocs->gl.calculate_divergence__divergence_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__u_min, _wcl_allocs->gl.calculate_divergence__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__v_min, _wcl_allocs->gl.calculate_divergence__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__w_min, _wcl_allocs->gl.calculate_divergence__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.zero_pressure__pressure_min, _wcl_allocs->gl.zero_pressure__pressure_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vector_dot_product__a_min, _wcl_allocs->gl.vector_dot_product__a_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vector_dot_product__b_min, _wcl_allocs->gl.vector_dot_product__b_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, _wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, _wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_solve__pressure_min, _wcl_allocs->gl.pressure_solve__pressure_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_solve__pressure_prev_min, _wcl_allocs->gl.pressure_solve__pressure_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_solve__divergence_min, _wcl_allocs->gl.pressure_solve__divergence_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__u_min, _wcl_allocs->gl.pressure_apply__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__v_min, _wcl_allocs->gl.pressure_apply__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__w_min, _wcl_allocs->gl.pressure_apply__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__pressure_min, _wcl_allocs->gl.pressure_apply__pressure_max, (__global uint*)0))))))))))))))))))))))))))))))))))))))))))));
    if (_wcl_allocs->gn == (__global uint*)0) return; // not enough space to meet the minimum access. Would be great if we could give info about the problem for the user. 
    _wcl_allocs->pn = _WCL_SET_NULL(__private uint*, _WCL_ADDRESS_SPACE_private_MIN, &_wcl_allocs->pa, (&_wcl_allocs->pa + 1), (__private uint*)0);
    if (_wcl_allocs->pn == (__private uint*)0) return; // not enough space to meet the minimum access. Would be great if we could give info about the problem for the user. 

  int id = get_global_id(0);
  int slice_size = 96*96;
  int row_size = 96;
  int k = id / slice_size;
  int j = (id - k*slice_size) / row_size;
  int i = id - j*row_size - k*slice_size;

  //if(i < 1 || j < 1 || (NZ > 1 && k < 1) || i > NX -1 || j > NY-1 || (NZ > 1 && k > NZ-1) || (NZ == 1 && k > 1))
  if(i < 1 || j < 1 || k < 0 || i >= 96 -1 || j >= 96 -1 || k > 1 )
    return;

  /*
  float4 curl;
  float4 curl_iplus1;
  float4 curl_iminus1;
  float4 curl_jplus1;
  float4 curl_jminus1;
  float4 curl_kplus1;
  float4 curl_kminus1;
  
  float4 norm;
  float4 f;
  */

    // calculate gradient of curl magnitude
    float4 curl_iplus1 = get_curl(_wcl_allocs, u_prev,v_prev, w_prev, i+1, j, k);
    float4 curl_iminus1= get_curl(_wcl_allocs, u_prev,v_prev, w_prev, i-1, j, k);

    float4 curl_jplus1 = get_curl(_wcl_allocs, u_prev,v_prev, w_prev, i, j+1, k);
    float4 curl_jminus1= get_curl(_wcl_allocs, u_prev,v_prev, w_prev, i, j-1, k);

    float4 curl_kplus1 = get_curl(_wcl_allocs, u_prev,v_prev, w_prev, i, j, k+1);
    float4 curl_kminus1 = get_curl(_wcl_allocs, u_prev,v_prev, w_prev, i, j, k-1);

    float dcdi = 0.5f*(length(curl_iplus1) - length(curl_iminus1));
    float dcdj = 0.5f*(length(curl_jplus1) - length(curl_jminus1));
    float dcdk = 0.5f*(length(curl_kplus1) - length(curl_kminus1));

    float4 norm = {0.0f, 0.0f, 0.0f, 0.0f};
    norm.x = dcdi;
    norm.y = dcdj;
    norm.z = dcdk;
    norm.w = 0.0f;

    norm = safe_normalize(_wcl_allocs, norm);

    float4 curl = get_curl(_wcl_allocs, u_prev,v_prev, w_prev, i, j, k);

    //float e = 0.5f;

    float4 f = cross(norm, curl);

    (*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((u)+(((i) + ((j)*(96)) + ((k)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn))) += f.x * e * dt;
    (*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((v)+(((i) + ((j)*(96)) + ((k)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn))) += f.y * e * dt;
    (*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((w)+(((i) + ((j)*(96)) + ((k)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn))) += f.z * e * dt;

}

__kernel void calculate_divergence(
            __global float *divergence, ulong _wcl_divergence_size,
            __global float *u, ulong _wcl_u_size,
            __global float *v, ulong _wcl_v_size,
            __global float *w, ulong _wcl_w_size,
           // int i, int j, int k, 
            int3 n,
            float dt )
{
local int hd4k_workaround_local;
hd4k_workaround_local = hd4k_workaround_constant;
    __local uint _wcl_local_null[_WCL_ADDRESS_SPACE_local_MIN];

    _WclProgramAllocations _wcl_allocations_allocation = {
        { 0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,&divergence[0], &divergence[_wcl_divergence_size],&u[0], &u[_wcl_u_size],&v[0], &v[_wcl_v_size],&w[0], &w[_wcl_w_size],0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0 },
        0,
        { },
        0

    };
    _WclProgramAllocations *_wcl_allocs = &_wcl_allocations_allocation;
    _wcl_allocs->gn = _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__q_min, _wcl_allocs->gl.advect_forward_euler__q_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__q_prev_min, _wcl_allocs->gl.advect_forward_euler__q_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__u_prev_min, _wcl_allocs->gl.advect_forward_euler__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__v_prev_min, _wcl_allocs->gl.advect_forward_euler__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__w_prev_min, _wcl_allocs->gl.advect_forward_euler__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__q_min, _wcl_allocs->gl.advectRK2__q_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__q_prev_min, _wcl_allocs->gl.advectRK2__q_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__u_prev_min, _wcl_allocs->gl.advectRK2__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__v_prev_min, _wcl_allocs->gl.advectRK2__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__w_prev_min, _wcl_allocs->gl.advectRK2__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__u_min, _wcl_allocs->gl.advect_velocity_RK2__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__v_min, _wcl_allocs->gl.advect_velocity_RK2__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__w_min, _wcl_allocs->gl.advect_velocity_RK2__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, _wcl_allocs->gl.advect_velocity_RK2__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, _wcl_allocs->gl.advect_velocity_RK2__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, _wcl_allocs->gl.advect_velocity_RK2__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__u_min, _wcl_allocs->gl.advect_velocity_forward_euler__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__v_min, _wcl_allocs->gl.advect_velocity_forward_euler__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__w_min, _wcl_allocs->gl.advect_velocity_forward_euler__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, _wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, _wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, _wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__u_min, _wcl_allocs->gl.vorticity_confinement__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__v_min, _wcl_allocs->gl.vorticity_confinement__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__w_min, _wcl_allocs->gl.vorticity_confinement__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__u_prev_min, _wcl_allocs->gl.vorticity_confinement__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__v_prev_min, _wcl_allocs->gl.vorticity_confinement__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__w_prev_min, _wcl_allocs->gl.vorticity_confinement__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__divergence_min, _wcl_allocs->gl.calculate_divergence__divergence_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__u_min, _wcl_allocs->gl.calculate_divergence__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__v_min, _wcl_allocs->gl.calculate_divergence__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__w_min, _wcl_allocs->gl.calculate_divergence__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.zero_pressure__pressure_min, _wcl_allocs->gl.zero_pressure__pressure_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vector_dot_product__a_min, _wcl_allocs->gl.vector_dot_product__a_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vector_dot_product__b_min, _wcl_allocs->gl.vector_dot_product__b_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, _wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, _wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_solve__pressure_min, _wcl_allocs->gl.pressure_solve__pressure_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_solve__pressure_prev_min, _wcl_allocs->gl.pressure_solve__pressure_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_solve__divergence_min, _wcl_allocs->gl.pressure_solve__divergence_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__u_min, _wcl_allocs->gl.pressure_apply__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__v_min, _wcl_allocs->gl.pressure_apply__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__w_min, _wcl_allocs->gl.pressure_apply__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__pressure_min, _wcl_allocs->gl.pressure_apply__pressure_max, (__global uint*)0))))))))))))))))))))))))))))))))))))))))))));
    if (_wcl_allocs->gn == (__global uint*)0) return; // not enough space to meet the minimum access. Would be great if we could give info about the problem for the user. 
    _wcl_allocs->pn = _WCL_SET_NULL(__private uint*, _WCL_ADDRESS_SPACE_private_MIN, &_wcl_allocs->pa, (&_wcl_allocs->pa + 1), (__private uint*)0);
    if (_wcl_allocs->pn == (__private uint*)0) return; // not enough space to meet the minimum access. Would be great if we could give info about the problem for the user. 

  {
    int id = get_global_id(0);
    int slice_size = 96*96;
    int row_size = 96;
    int k = id / slice_size;
    int j = (id - k*slice_size) / row_size;
    int i = id - j*row_size - k*slice_size;

    float du = get_data(_wcl_allocs, u,i+1,j,k) - get_data(_wcl_allocs, u,i-1,j,k);
    float dv = get_data(_wcl_allocs, v,i,j+1,k) - get_data(_wcl_allocs, v,i,j-1,k);
    float dw = get_data(_wcl_allocs, w,i,j,k+1) - get_data(_wcl_allocs, w,i,j,k-1);
    float div = 0.5f*(du + dv + dw);

    (*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((divergence)+(((i) + ((j)*(96)) + ((k)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn))) = div;

    barrier(CLK_GLOBAL_MEM_FENCE);
  }
}

__kernel void zero_pressure( __global float *pressure, ulong _wcl_pressure_size)
{
local int hd4k_workaround_local;
hd4k_workaround_local = hd4k_workaround_constant;
    __local uint _wcl_local_null[_WCL_ADDRESS_SPACE_local_MIN];

    _WclProgramAllocations _wcl_allocations_allocation = {
        { 0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,&pressure[0], &pressure[_wcl_pressure_size],0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0 },
        0,
        { },
        0

    };
    _WclProgramAllocations *_wcl_allocs = &_wcl_allocations_allocation;
    _wcl_allocs->gn = _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__q_min, _wcl_allocs->gl.advect_forward_euler__q_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__q_prev_min, _wcl_allocs->gl.advect_forward_euler__q_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__u_prev_min, _wcl_allocs->gl.advect_forward_euler__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__v_prev_min, _wcl_allocs->gl.advect_forward_euler__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__w_prev_min, _wcl_allocs->gl.advect_forward_euler__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__q_min, _wcl_allocs->gl.advectRK2__q_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__q_prev_min, _wcl_allocs->gl.advectRK2__q_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__u_prev_min, _wcl_allocs->gl.advectRK2__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__v_prev_min, _wcl_allocs->gl.advectRK2__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__w_prev_min, _wcl_allocs->gl.advectRK2__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__u_min, _wcl_allocs->gl.advect_velocity_RK2__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__v_min, _wcl_allocs->gl.advect_velocity_RK2__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__w_min, _wcl_allocs->gl.advect_velocity_RK2__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, _wcl_allocs->gl.advect_velocity_RK2__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, _wcl_allocs->gl.advect_velocity_RK2__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, _wcl_allocs->gl.advect_velocity_RK2__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__u_min, _wcl_allocs->gl.advect_velocity_forward_euler__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__v_min, _wcl_allocs->gl.advect_velocity_forward_euler__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__w_min, _wcl_allocs->gl.advect_velocity_forward_euler__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, _wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, _wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, _wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__u_min, _wcl_allocs->gl.vorticity_confinement__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__v_min, _wcl_allocs->gl.vorticity_confinement__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__w_min, _wcl_allocs->gl.vorticity_confinement__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__u_prev_min, _wcl_allocs->gl.vorticity_confinement__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__v_prev_min, _wcl_allocs->gl.vorticity_confinement__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__w_prev_min, _wcl_allocs->gl.vorticity_confinement__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__divergence_min, _wcl_allocs->gl.calculate_divergence__divergence_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__u_min, _wcl_allocs->gl.calculate_divergence__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__v_min, _wcl_allocs->gl.calculate_divergence__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__w_min, _wcl_allocs->gl.calculate_divergence__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.zero_pressure__pressure_min, _wcl_allocs->gl.zero_pressure__pressure_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vector_dot_product__a_min, _wcl_allocs->gl.vector_dot_product__a_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vector_dot_product__b_min, _wcl_allocs->gl.vector_dot_product__b_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, _wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, _wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_solve__pressure_min, _wcl_allocs->gl.pressure_solve__pressure_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_solve__pressure_prev_min, _wcl_allocs->gl.pressure_solve__pressure_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_solve__divergence_min, _wcl_allocs->gl.pressure_solve__divergence_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__u_min, _wcl_allocs->gl.pressure_apply__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__v_min, _wcl_allocs->gl.pressure_apply__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__w_min, _wcl_allocs->gl.pressure_apply__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__pressure_min, _wcl_allocs->gl.pressure_apply__pressure_max, (__global uint*)0))))))))))))))))))))))))))))))))))))))))))));
    if (_wcl_allocs->gn == (__global uint*)0) return; // not enough space to meet the minimum access. Would be great if we could give info about the problem for the user. 
    _wcl_allocs->pn = _WCL_SET_NULL(__private uint*, _WCL_ADDRESS_SPACE_private_MIN, &_wcl_allocs->pa, (&_wcl_allocs->pa + 1), (__private uint*)0);
    if (_wcl_allocs->pn == (__private uint*)0) return; // not enough space to meet the minimum access. Would be great if we could give info about the problem for the user. 

  int id = get_global_id(0);

  (*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((pressure)+(id), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn))) = 0.0f;

}

__kernel void vector_dot_product(
                                    __global float* a, ulong _wcl_a_size,
                                    __global float* b, ulong _wcl_b_size,
                                    int n) {
local int hd4k_workaround_local;
hd4k_workaround_local = hd4k_workaround_constant;
    __local uint _wcl_local_null[_WCL_ADDRESS_SPACE_local_MIN];

    _WclProgramAllocations _wcl_allocations_allocation = {
        { 0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,&a[0], &a[_wcl_a_size],&b[0], &b[_wcl_b_size],0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0 },
        0,
        { },
        0

    };
    _WclProgramAllocations *_wcl_allocs = &_wcl_allocations_allocation;
    _wcl_allocs->gn = _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__q_min, _wcl_allocs->gl.advect_forward_euler__q_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__q_prev_min, _wcl_allocs->gl.advect_forward_euler__q_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__u_prev_min, _wcl_allocs->gl.advect_forward_euler__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__v_prev_min, _wcl_allocs->gl.advect_forward_euler__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__w_prev_min, _wcl_allocs->gl.advect_forward_euler__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__q_min, _wcl_allocs->gl.advectRK2__q_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__q_prev_min, _wcl_allocs->gl.advectRK2__q_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__u_prev_min, _wcl_allocs->gl.advectRK2__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__v_prev_min, _wcl_allocs->gl.advectRK2__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__w_prev_min, _wcl_allocs->gl.advectRK2__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__u_min, _wcl_allocs->gl.advect_velocity_RK2__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__v_min, _wcl_allocs->gl.advect_velocity_RK2__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__w_min, _wcl_allocs->gl.advect_velocity_RK2__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, _wcl_allocs->gl.advect_velocity_RK2__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, _wcl_allocs->gl.advect_velocity_RK2__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, _wcl_allocs->gl.advect_velocity_RK2__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__u_min, _wcl_allocs->gl.advect_velocity_forward_euler__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__v_min, _wcl_allocs->gl.advect_velocity_forward_euler__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__w_min, _wcl_allocs->gl.advect_velocity_forward_euler__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, _wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, _wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, _wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__u_min, _wcl_allocs->gl.vorticity_confinement__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__v_min, _wcl_allocs->gl.vorticity_confinement__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__w_min, _wcl_allocs->gl.vorticity_confinement__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__u_prev_min, _wcl_allocs->gl.vorticity_confinement__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__v_prev_min, _wcl_allocs->gl.vorticity_confinement__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__w_prev_min, _wcl_allocs->gl.vorticity_confinement__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__divergence_min, _wcl_allocs->gl.calculate_divergence__divergence_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__u_min, _wcl_allocs->gl.calculate_divergence__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__v_min, _wcl_allocs->gl.calculate_divergence__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__w_min, _wcl_allocs->gl.calculate_divergence__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.zero_pressure__pressure_min, _wcl_allocs->gl.zero_pressure__pressure_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vector_dot_product__a_min, _wcl_allocs->gl.vector_dot_product__a_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vector_dot_product__b_min, _wcl_allocs->gl.vector_dot_product__b_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, _wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, _wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_solve__pressure_min, _wcl_allocs->gl.pressure_solve__pressure_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_solve__pressure_prev_min, _wcl_allocs->gl.pressure_solve__pressure_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_solve__divergence_min, _wcl_allocs->gl.pressure_solve__divergence_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__u_min, _wcl_allocs->gl.pressure_apply__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__v_min, _wcl_allocs->gl.pressure_apply__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__w_min, _wcl_allocs->gl.pressure_apply__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__pressure_min, _wcl_allocs->gl.pressure_apply__pressure_max, (__global uint*)0))))))))))))))))))))))))))))))))))))))))))));
    if (_wcl_allocs->gn == (__global uint*)0) return; // not enough space to meet the minimum access. Would be great if we could give info about the problem for the user. 
    _wcl_allocs->pn = _WCL_SET_NULL(__private uint*, _WCL_ADDRESS_SPACE_private_MIN, &_wcl_allocs->pa, (&_wcl_allocs->pa + 1), (__private uint*)0);
    if (_wcl_allocs->pn == (__private uint*)0) return; // not enough space to meet the minimum access. Would be great if we could give info about the problem for the user. 


}

__kernel void laplacian_mtx_vec_mult(
                                     __global float *out, ulong _wcl_out_size,
                                     __global float* x, ulong _wcl_x_size,
                                     int3 n) {
local int hd4k_workaround_local;
hd4k_workaround_local = hd4k_workaround_constant;
    __local uint _wcl_local_null[_WCL_ADDRESS_SPACE_local_MIN];

    _WclProgramAllocations _wcl_allocations_allocation = {
        { 0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,&out[0], &out[_wcl_out_size],&x[0], &x[_wcl_x_size],0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0 },
        0,
        { },
        0

    };
    _WclProgramAllocations *_wcl_allocs = &_wcl_allocations_allocation;
    _wcl_allocs->gn = _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__q_min, _wcl_allocs->gl.advect_forward_euler__q_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__q_prev_min, _wcl_allocs->gl.advect_forward_euler__q_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__u_prev_min, _wcl_allocs->gl.advect_forward_euler__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__v_prev_min, _wcl_allocs->gl.advect_forward_euler__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__w_prev_min, _wcl_allocs->gl.advect_forward_euler__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__q_min, _wcl_allocs->gl.advectRK2__q_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__q_prev_min, _wcl_allocs->gl.advectRK2__q_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__u_prev_min, _wcl_allocs->gl.advectRK2__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__v_prev_min, _wcl_allocs->gl.advectRK2__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__w_prev_min, _wcl_allocs->gl.advectRK2__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__u_min, _wcl_allocs->gl.advect_velocity_RK2__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__v_min, _wcl_allocs->gl.advect_velocity_RK2__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__w_min, _wcl_allocs->gl.advect_velocity_RK2__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, _wcl_allocs->gl.advect_velocity_RK2__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, _wcl_allocs->gl.advect_velocity_RK2__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, _wcl_allocs->gl.advect_velocity_RK2__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__u_min, _wcl_allocs->gl.advect_velocity_forward_euler__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__v_min, _wcl_allocs->gl.advect_velocity_forward_euler__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__w_min, _wcl_allocs->gl.advect_velocity_forward_euler__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, _wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, _wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, _wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__u_min, _wcl_allocs->gl.vorticity_confinement__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__v_min, _wcl_allocs->gl.vorticity_confinement__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__w_min, _wcl_allocs->gl.vorticity_confinement__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__u_prev_min, _wcl_allocs->gl.vorticity_confinement__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__v_prev_min, _wcl_allocs->gl.vorticity_confinement__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__w_prev_min, _wcl_allocs->gl.vorticity_confinement__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__divergence_min, _wcl_allocs->gl.calculate_divergence__divergence_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__u_min, _wcl_allocs->gl.calculate_divergence__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__v_min, _wcl_allocs->gl.calculate_divergence__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__w_min, _wcl_allocs->gl.calculate_divergence__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.zero_pressure__pressure_min, _wcl_allocs->gl.zero_pressure__pressure_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vector_dot_product__a_min, _wcl_allocs->gl.vector_dot_product__a_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vector_dot_product__b_min, _wcl_allocs->gl.vector_dot_product__b_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, _wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, _wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_solve__pressure_min, _wcl_allocs->gl.pressure_solve__pressure_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_solve__pressure_prev_min, _wcl_allocs->gl.pressure_solve__pressure_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_solve__divergence_min, _wcl_allocs->gl.pressure_solve__divergence_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__u_min, _wcl_allocs->gl.pressure_apply__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__v_min, _wcl_allocs->gl.pressure_apply__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__w_min, _wcl_allocs->gl.pressure_apply__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__pressure_min, _wcl_allocs->gl.pressure_apply__pressure_max, (__global uint*)0))))))))))))))))))))))))))))))))))))))))))));
    if (_wcl_allocs->gn == (__global uint*)0) return; // not enough space to meet the minimum access. Would be great if we could give info about the problem for the user. 
    _wcl_allocs->pn = _WCL_SET_NULL(__private uint*, _WCL_ADDRESS_SPACE_private_MIN, &_wcl_allocs->pa, (&_wcl_allocs->pa + 1), (__private uint*)0);
    if (_wcl_allocs->pn == (__private uint*)0) return; // not enough space to meet the minimum access. Would be great if we could give info about the problem for the user. 


  int id = get_global_id(0);
  int slice_size = 96*96;
  int row_size = 96;
  int k = id / slice_size;
  int j = (id - k*slice_size) / row_size;
  int i = id - j*row_size - k*slice_size;


  float sum = 0.0f;
  sum += -6.0f * (*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((x)+(id), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn)));
  sum += get_data(_wcl_allocs, x,i-1,j,k);
  sum += get_data(_wcl_allocs, x,i+1,j,k);
  sum += get_data(_wcl_allocs, x,i,j-1,k);
  sum += get_data(_wcl_allocs, x,i,j+1,k);
  sum += get_data(_wcl_allocs, x,i,j,k-1);
  sum += get_data(_wcl_allocs, x,i,j,k+1);

  (*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((out)+(id), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn))) = sum;
}

__kernel void pressure_solve(
          __global float *pressure, ulong _wcl_pressure_size,
          __global float *pressure_prev, ulong _wcl_pressure_prev_size,
          __global float *divergence, ulong _wcl_divergence_size,
         // int i, int j, int k, 
          int3 n,
          float dt)
{
local int hd4k_workaround_local;
hd4k_workaround_local = hd4k_workaround_constant;
    __local uint _wcl_local_null[_WCL_ADDRESS_SPACE_local_MIN];

    _WclProgramAllocations _wcl_allocations_allocation = {
        { 0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,&pressure[0], &pressure[_wcl_pressure_size],&pressure_prev[0], &pressure_prev[_wcl_pressure_prev_size],&divergence[0], &divergence[_wcl_divergence_size],0, 0,0, 0,0, 0,0, 0 },
        0,
        { },
        0

    };
    _WclProgramAllocations *_wcl_allocs = &_wcl_allocations_allocation;
    _wcl_allocs->gn = _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__q_min, _wcl_allocs->gl.advect_forward_euler__q_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__q_prev_min, _wcl_allocs->gl.advect_forward_euler__q_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__u_prev_min, _wcl_allocs->gl.advect_forward_euler__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__v_prev_min, _wcl_allocs->gl.advect_forward_euler__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__w_prev_min, _wcl_allocs->gl.advect_forward_euler__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__q_min, _wcl_allocs->gl.advectRK2__q_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__q_prev_min, _wcl_allocs->gl.advectRK2__q_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__u_prev_min, _wcl_allocs->gl.advectRK2__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__v_prev_min, _wcl_allocs->gl.advectRK2__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__w_prev_min, _wcl_allocs->gl.advectRK2__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__u_min, _wcl_allocs->gl.advect_velocity_RK2__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__v_min, _wcl_allocs->gl.advect_velocity_RK2__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__w_min, _wcl_allocs->gl.advect_velocity_RK2__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, _wcl_allocs->gl.advect_velocity_RK2__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, _wcl_allocs->gl.advect_velocity_RK2__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, _wcl_allocs->gl.advect_velocity_RK2__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__u_min, _wcl_allocs->gl.advect_velocity_forward_euler__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__v_min, _wcl_allocs->gl.advect_velocity_forward_euler__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__w_min, _wcl_allocs->gl.advect_velocity_forward_euler__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, _wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, _wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, _wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__u_min, _wcl_allocs->gl.vorticity_confinement__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__v_min, _wcl_allocs->gl.vorticity_confinement__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__w_min, _wcl_allocs->gl.vorticity_confinement__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__u_prev_min, _wcl_allocs->gl.vorticity_confinement__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__v_prev_min, _wcl_allocs->gl.vorticity_confinement__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__w_prev_min, _wcl_allocs->gl.vorticity_confinement__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__divergence_min, _wcl_allocs->gl.calculate_divergence__divergence_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__u_min, _wcl_allocs->gl.calculate_divergence__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__v_min, _wcl_allocs->gl.calculate_divergence__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__w_min, _wcl_allocs->gl.calculate_divergence__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.zero_pressure__pressure_min, _wcl_allocs->gl.zero_pressure__pressure_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vector_dot_product__a_min, _wcl_allocs->gl.vector_dot_product__a_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vector_dot_product__b_min, _wcl_allocs->gl.vector_dot_product__b_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, _wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, _wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_solve__pressure_min, _wcl_allocs->gl.pressure_solve__pressure_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_solve__pressure_prev_min, _wcl_allocs->gl.pressure_solve__pressure_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_solve__divergence_min, _wcl_allocs->gl.pressure_solve__divergence_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__u_min, _wcl_allocs->gl.pressure_apply__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__v_min, _wcl_allocs->gl.pressure_apply__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__w_min, _wcl_allocs->gl.pressure_apply__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__pressure_min, _wcl_allocs->gl.pressure_apply__pressure_max, (__global uint*)0))))))))))))))))))))))))))))))))))))))))))));
    if (_wcl_allocs->gn == (__global uint*)0) return; // not enough space to meet the minimum access. Would be great if we could give info about the problem for the user. 
    _wcl_allocs->pn = _WCL_SET_NULL(__private uint*, _WCL_ADDRESS_SPACE_private_MIN, &_wcl_allocs->pa, (&_wcl_allocs->pa + 1), (__private uint*)0);
    if (_wcl_allocs->pn == (__private uint*)0) return; // not enough space to meet the minimum access. Would be great if we could give info about the problem for the user. 

  int id = get_global_id(0);
  int slice_size = 96*96;
  int row_size = 96;
  int k = id / slice_size;
  int j = (id - k*slice_size) / row_size;
  int i = id - j*row_size - k*slice_size;




  // jacobi solver
  float p = -get_data(_wcl_allocs, divergence,i,j,k);
  float a = get_data(_wcl_allocs, pressure,i-1, j, k);
  float b = get_data(_wcl_allocs, pressure,i+1, j, k);
  float c = get_data(_wcl_allocs, pressure,i, j+1, k);
  float d = get_data(_wcl_allocs, pressure,i, j-1, k);
  float e = get_data(_wcl_allocs, pressure,i, j, k-1);
  float f = get_data(_wcl_allocs, pressure,i, j, k+1);
  float v = (p+(a+b+c+d+e+f))/6.0f;

  (*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((pressure)+(((i) + ((j)*(96)) + ((k)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn))) = v;

}

__kernel void pressure_apply(__global float *u, ulong _wcl_u_size,
                    __global float *v, ulong _wcl_v_size,
                    __global float *w, ulong _wcl_w_size,
                    __global float *pressure, ulong _wcl_pressure_size,
                    //int i, int j, int k, 
                    int3 n,
                    float dt)
{
local int hd4k_workaround_local;
hd4k_workaround_local = hd4k_workaround_constant;
    __local uint _wcl_local_null[_WCL_ADDRESS_SPACE_local_MIN];

    _WclProgramAllocations _wcl_allocations_allocation = {
        { 0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,&u[0], &u[_wcl_u_size],&v[0], &v[_wcl_v_size],&w[0], &w[_wcl_w_size],&pressure[0], &pressure[_wcl_pressure_size] },
        0,
        { },
        0

    };
    _WclProgramAllocations *_wcl_allocs = &_wcl_allocations_allocation;
    _wcl_allocs->gn = _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__q_min, _wcl_allocs->gl.advect_forward_euler__q_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__q_prev_min, _wcl_allocs->gl.advect_forward_euler__q_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__u_prev_min, _wcl_allocs->gl.advect_forward_euler__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__v_prev_min, _wcl_allocs->gl.advect_forward_euler__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_forward_euler__w_prev_min, _wcl_allocs->gl.advect_forward_euler__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__q_min, _wcl_allocs->gl.advectRK2__q_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__q_prev_min, _wcl_allocs->gl.advectRK2__q_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__u_prev_min, _wcl_allocs->gl.advectRK2__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__v_prev_min, _wcl_allocs->gl.advectRK2__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advectRK2__w_prev_min, _wcl_allocs->gl.advectRK2__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__u_min, _wcl_allocs->gl.advect_velocity_RK2__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__v_min, _wcl_allocs->gl.advect_velocity_RK2__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__w_min, _wcl_allocs->gl.advect_velocity_RK2__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, _wcl_allocs->gl.advect_velocity_RK2__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, _wcl_allocs->gl.advect_velocity_RK2__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, _wcl_allocs->gl.advect_velocity_RK2__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__u_min, _wcl_allocs->gl.advect_velocity_forward_euler__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__v_min, _wcl_allocs->gl.advect_velocity_forward_euler__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__w_min, _wcl_allocs->gl.advect_velocity_forward_euler__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, _wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, _wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, _wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__u_min, _wcl_allocs->gl.vorticity_confinement__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__v_min, _wcl_allocs->gl.vorticity_confinement__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__w_min, _wcl_allocs->gl.vorticity_confinement__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__u_prev_min, _wcl_allocs->gl.vorticity_confinement__u_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__v_prev_min, _wcl_allocs->gl.vorticity_confinement__v_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vorticity_confinement__w_prev_min, _wcl_allocs->gl.vorticity_confinement__w_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__divergence_min, _wcl_allocs->gl.calculate_divergence__divergence_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__u_min, _wcl_allocs->gl.calculate_divergence__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__v_min, _wcl_allocs->gl.calculate_divergence__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.calculate_divergence__w_min, _wcl_allocs->gl.calculate_divergence__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.zero_pressure__pressure_min, _wcl_allocs->gl.zero_pressure__pressure_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vector_dot_product__a_min, _wcl_allocs->gl.vector_dot_product__a_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.vector_dot_product__b_min, _wcl_allocs->gl.vector_dot_product__b_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, _wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, _wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_solve__pressure_min, _wcl_allocs->gl.pressure_solve__pressure_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_solve__pressure_prev_min, _wcl_allocs->gl.pressure_solve__pressure_prev_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_solve__divergence_min, _wcl_allocs->gl.pressure_solve__divergence_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__u_min, _wcl_allocs->gl.pressure_apply__u_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__v_min, _wcl_allocs->gl.pressure_apply__v_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__w_min, _wcl_allocs->gl.pressure_apply__w_max, _WCL_SET_NULL(__global uint*, _WCL_ADDRESS_SPACE_global_MIN,_wcl_allocs->gl.pressure_apply__pressure_min, _wcl_allocs->gl.pressure_apply__pressure_max, (__global uint*)0))))))))))))))))))))))))))))))))))))))))))));
    if (_wcl_allocs->gn == (__global uint*)0) return; // not enough space to meet the minimum access. Would be great if we could give info about the problem for the user. 
    _wcl_allocs->pn = _WCL_SET_NULL(__private uint*, _WCL_ADDRESS_SPACE_private_MIN, &_wcl_allocs->pa, (&_wcl_allocs->pa + 1), (__private uint*)0);
    if (_wcl_allocs->pn == (__private uint*)0) return; // not enough space to meet the minimum access. Would be great if we could give info about the problem for the user. 

  int id = get_global_id(0);
  int slice_size = 96*96;
  int row_size = 96;
  int k = id / slice_size;
  int j = (id - k*slice_size) / row_size;
  int i = id - j*row_size - k*slice_size;

//  int lid = get_local_id(0);
//  int local_slice_size = BLOCK_SIZE*BLOCK_SIZE;
//  int local_row_size = BLOCK_SIZE;
//  int lk = lid / local_slice_size;
//  int lj = (lid - lk*local_slice_size) / local_row_size;
//  int li = lid - lj*local_row_size - lk*local_slice_size;
//  
//  
//  //Put stuff into local memory
//  local float local_pressure[(BLOCK_SIZE_WITH_PAD)*(BLOCK_SIZE_WITH_PAD)*(BLOCK_SIZE_WITH_PAD)];//Should be 10*10*10 = 1000
//  //Handle normal case
//  int local_index = IXL(li+1, lj+1, lk+1);
//  local_pressure[local_index] = pressure[id];
//  
//  //Handle edge cases
//  //The left face
//  if(li == 0){
//    local_pressure[IXL(li, lj+1, lk+1)] = get_data(pressure, i-1,j,k);
//  }
//  //The right face
//  if(li == BLOCK_SIZE-1){
//    local_pressure[IXL(li+2, lj+1, lk+1)] = get_data(pressure, i+1,j,k);
//  }
//  //the top face
//  if(lj == 0){
//    local_pressure[IXL(li+1, lj, lk+1)] = get_data(pressure, i,j-1,k);
//  }
//  //the bottom face
//  if(lj == BLOCK_SIZE-1){
//    local_pressure[IXL(li+1, lj+2, lk+1)] = get_data(pressure, i,j+1,k);
//  }
//  //the front face
//  if(lk == 0){
//    local_pressure[IXL(li+1, lj+1, lk)] = get_data(pressure, i,j,k-1);
//  }
//  //the bottom face
//  if(lk == BLOCK_SIZE-1){
//    local_pressure[IXL(li+1, lj+1, lk+2)] = get_data(pressure, i,j,k+1);
//  }
//  
//  
//  barrier(CLK_LOCAL_MEM_FENCE);


  // calculate pressure gradient
  float dpdi = 0.5f*(get_data(_wcl_allocs, pressure,i+1, j, k)-get_data(_wcl_allocs, pressure,i-1, j, k));
  float dpdj = 0.5f*(get_data(_wcl_allocs, pressure,i, j+1, k)-get_data(_wcl_allocs, pressure,i, j-1, k));
  float dpdk = 0.5f*(get_data(_wcl_allocs, pressure,i, j, k+1)-get_data(_wcl_allocs, pressure,i, j, k-1));

//  float dpdi = 0.5f*(get_data_local(local_pressure,li+2, lj+1, lk+1)-get_data_local(local_pressure,li, lj+1, lk+1));
//  float dpdj = 0.5f*(get_data_local(local_pressure,li+1, lj+2, lk+1)-get_data_local(local_pressure,li+1, lj, lk+1));
//  float dpdk = 0.5f*(get_data_local(local_pressure,li+1, lj+1, lk+2)-get_data_local(local_pressure,li+1, lj+1, lk));

  (*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((u)+(((i) + ((j)*(96)) + ((k)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn))) -= dpdi;
  (*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((v)+(((i) + ((j)*(96)) + ((k)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn))) -= dpdj;
  (*(_wcl_addr_clamp_global_44__u_uglobal__float__Ptr((w)+(((i) + ((j)*(96)) + ((k)*(96)*(96)))), 1, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__q_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__q_min, (__global float *)_wcl_allocs->gl.advectRK2__q_max, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__q_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__u_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__v_prev_max, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_min, (__global float *)_wcl_allocs->gl.advectRK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_RK2__w_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__u_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__v_prev_max, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_min, (__global float *)_wcl_allocs->gl.advect_velocity_forward_euler__w_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__u_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__v_prev_max, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_min, (__global float *)_wcl_allocs->gl.vorticity_confinement__w_prev_max, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_min, (__global float *)_wcl_allocs->gl.calculate_divergence__divergence_max, (__global float *)_wcl_allocs->gl.calculate_divergence__u_min, (__global float *)_wcl_allocs->gl.calculate_divergence__u_max, (__global float *)_wcl_allocs->gl.calculate_divergence__v_min, (__global float *)_wcl_allocs->gl.calculate_divergence__v_max, (__global float *)_wcl_allocs->gl.calculate_divergence__w_min, (__global float *)_wcl_allocs->gl.calculate_divergence__w_max, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_min, (__global float *)_wcl_allocs->gl.zero_pressure__pressure_max, (__global float *)_wcl_allocs->gl.vector_dot_product__a_min, (__global float *)_wcl_allocs->gl.vector_dot_product__a_max, (__global float *)_wcl_allocs->gl.vector_dot_product__b_min, (__global float *)_wcl_allocs->gl.vector_dot_product__b_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__out_max, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_min, (__global float *)_wcl_allocs->gl.laplacian_mtx_vec_mult__x_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_max, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_min, (__global float *)_wcl_allocs->gl.pressure_solve__pressure_prev_max, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_min, (__global float *)_wcl_allocs->gl.pressure_solve__divergence_max, (__global float *)_wcl_allocs->gl.pressure_apply__u_min, (__global float *)_wcl_allocs->gl.pressure_apply__u_max, (__global float *)_wcl_allocs->gl.pressure_apply__v_min, (__global float *)_wcl_allocs->gl.pressure_apply__v_max, (__global float *)_wcl_allocs->gl.pressure_apply__w_min, (__global float *)_wcl_allocs->gl.pressure_apply__w_max, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_min, (__global float *)_wcl_allocs->gl.pressure_apply__pressure_max, (__global float *)_wcl_allocs->gn))) -= dpdk;
}
